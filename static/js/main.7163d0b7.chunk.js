(this["webpackJsonpconcore-editor"]=this["webpackJsonpconcore-editor"]||[]).push([[0],{134:function(e,t,a){},14:function(e,t,a){"use strict";t.a={ADD_NODE:"ADD_NODE",ADD_EDGE:"ADD_EDGE",UPDATE_NODE:"UPDATE_NODE",UPDATE_EDGE:"UPDATE_EDGE",UPDATE_DATA:"UPDATE_DATA",DEL_NODE:"DEL_NODE",DEL_EDGE:"DEL_EDGE",SET_POS:"SET_POS",SET_DIM:"SET_DIM",SET_BENDW:"SET_BENDW"}},145:function(module,__webpack_exports__,__webpack_require__){"use strict";var _calculations_bending_dist_weight__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(45),_graph_actions__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(14),_reducer__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7),_2_canvas__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(160);class GraphComponent extends _2_canvas__WEBPACK_IMPORTED_MODULE_3__.a{constructor(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];super(...t);const[,,,,,s,r]=t;this.setEdgeNodeValidator({nodeValidator:s,edgeValidator:r}),this.getTid=()=>(new Date).getTime()}getPos(){const e=this.cy.$("node"),t={x:100,y:100};let a=!0;for(;a;){a=!1;for(let s=0;s<e.length;s+=1){const r=e[s].position();a=a||r.x===t.x&&r.y===t.y}a&&(t.x+=10,t.y+=10)}return t}addNode(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ordin",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getPos(),r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=arguments.length>5?arguments[5]:void 0,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this.getTid();const o=this.cy.add({group:"nodes",data:{...r,id:i,label:e,type:a,style:t},position:s});return this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.DEL_NODE,parameters:[o.id()]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.ADD_NODE,parameters:[e,t,a,s,r,o.id()]},n),o}getEdgesBetweenNodes(e,t){return this.getById(e).edgesWith(this.getById(t))}getBendingD(e,t){const a=this.getEdgesBetweenNodes(e,t),s=new Set;a.forEach((e=>{t===e.target().id()?s.add(e.data("bendData").bendDistance):s.add(-e.data("bendData").bendDistance)}));for(let r=0;;r+=20){if(!s.has(r))return r;if(!s.has(-r))return-r}}parseBendinDW(e){let{sourceID:t,targetID:a,type:s,bendWeight:r,bendDistance:i,bendPoint:n}=e;if("ordin"!==s)return{bendDistance:0,bendWeight:0};if(i&&r)return{bendDistance:i,bendWeight:r};if(n){const{x:e,y:s}=n,{d:r,w:i}=_calculations_bending_dist_weight__WEBPACK_IMPORTED_MODULE_0__.a.getWeightDistance({x:e,y:s},this.getById(t).position(),this.getById(a).position());return{bendDistance:r,bendWeight:i}}return{bendDistance:this.getBendingD(t,a),bendWeight:.5}}addEdgeWithLabel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();const{type:a="ordin"}=e,s=this.parseBendinDW({...e,...e.bendData}),r=this.cy.add({group:"edges",data:{...e,source:e.sourceID,target:e.targetID,type:a,bendData:s}});return this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.DEL_EDGE,parameters:[r.id()]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.ADD_EDGE,parameters:[{...e,id:r.id()}]},t),r}addEdge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();if(e.type&&"ordin"!==e.type||e.label)return this.addEdgeWithLabel({...e,type:e.type||"ordin"},t);this.dispatcher({type:_reducer__WEBPACK_IMPORTED_MODULE_2__.a.Model_Open_Create_Edge,cb:(a,s)=>{const r=this.validiateEdge(a,s,e.targetID,e.targetID,null,"New");return r.ok&&this.addEdgeWithLabel({...e,type:e.type||"ordin"},t),r}})}getStyle(e){return this.getById(e).data("style")}getLabel(e){return this.getById(e).data("label")||this.getById(e).data("label")}updateNode(e,t,a,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getTid();this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.UPDATE_NODE,parameters:[e,this.getStyle(e),this.getById(e).data("label"),s]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.UPDATE_NODE,parameters:[e,t,a,s]},r),s&&this.getById(e).data("label",a),this.getById(e).data("style",t)}updateEdge(e,t,a,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getTid();this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.UPDATE_EDGE,parameters:[e,this.getStyle(e),this.getById(e).data("label"),s]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.UPDATE_EDGE,parameters:[e,t,a,s]},r),s&&this.getById(e).data("label",a),this.getById(e).data("style",t)}updateData(e,t,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.getTid();return this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.UPDATE_DATA,parameters:[e,t,this.getById(e).data(t)]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.UPDATE_DATA,parameters:[e,t,a]},s),this.getById(e).data(t,a),this}deleteNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();const a=this.getById(e);a.connectedEdges('[type="ordin"]').forEach((e=>this.deleteEdge(e.id(),t))),a.connectedEdges().forEach((e=>this.deleteEdge(e.id(),t))),this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.ADD_NODE,parameters:[a.data("label"),this.getStyle(a.id()),a.data("type"),a.position(),a.json().data,e]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.DEL_NODE,parameters:[e]},t),a.remove()}deleteEdge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();if(0===this.getById(e).length||this.getById(e).removed())return;const a=this.getById(e).json();this.addAction({actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.ADD_EDGE,parameters:[{...a.data,sourceID:a.data.source,targetID:a.data.target}]},{actionName:_graph_actions__WEBPACK_IMPORTED_MODULE_1__.a.DEL_EDGE,parameters:[e]},t),this.getById(e).remove()}deleteElem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();return this.getById(e).isNode()?this.deleteNode(e,t):this.deleteEdge(e,t)}setPos(e,t){this.getById(e).position(t),this.getById(e).emit("moved")}setDim(e,t,a){const s=this.getById(e).data("style");this.getById(e).data("style",{...s,height:t.height,width:t.width}),this.setPos(e,a)}getNodeValidator(){const[e,t]=[this.nodeValidator.toString().indexOf("{"),this.nodeValidator.toString().lastIndexOf("}")];return this.nodeValidator.toString().slice(e+1,t).trim()}getEdgeValidator(){const[e,t]=[this.edgeValidator.toString().indexOf("{"),this.edgeValidator.toString().lastIndexOf("}")];return this.edgeValidator.toString().slice(e+1,t).trim()}setEdgeNodeValidator(_ref2){let{nodeValidator:nodeValidator,edgeValidator:edgeValidator}=_ref2;this.nodeValidator=eval(nodeValidator),this.edgeValidator=eval(edgeValidator)}getNodesEdges(){return[this.cy.$('node[type="ordin"]').map((e=>({label:e.data("label"),style:e.data("style"),id:e.data("id")}))),this.cy.$('edge[type="ordin"]').map((e=>({label:e.data("label"),sourceLabel:this.getById(this.getRealSourceId(e.source().id())).data("label"),targetLabel:e.target().data("label"),style:e.data("style"),id:e.data("id")})))]}validiateComp(e,t,a){const[s,r]=this.getNodesEdges();try{const i=t(e,s,r,a);return i&&void 0!==i.ok&&void 0!==i.err?i:{ok:!1,err:"Invalid return format from the defined validator."}}catch(i){return{ok:!1,err:`Error raised at validator: ${i.message}`}}}validiateNode(e,t,a,s){if(a){const r=this.getById(a);return this.validiateComp({label:e||r.data("label"),style:t||r.data("style"),id:a},this.nodeValidator,s)}return this.validiateComp({label:e,style:t,id:a},this.nodeValidator,s)}validiateEdge(e,t,a,s,r,i){if(r){const a=this.getById(r);return this.validiateComp({label:e||a.data("label"),style:t||a.data("style"),sourceLabel:this.getById(this.getRealSourceId(a.source().id())).data("label"),targetLabel:a.target().data("label"),id:r},this.edgeValidator,i)}return this.validiateComp({label:e,style:t,sourceLabel:this.getById(this.getRealSourceId(a)).data("label"),targetLabel:this.getById(s).data("label"),id:r},this.edgeValidator,i)}}__webpack_exports__.a=GraphComponent},160:function(e,t,a){"use strict";var s=a(42),r=a(146),i=a.n(r),n=a(147),o=a.n(n),l=a(148),d=a.n(l),c=a(149),h=a.n(c),p=a(150),u=a.n(p),b=a(70),y=a(45),g=a(7);class m{constructor(e,t,a,r,n,l,c,p){a&&(this.dispatcher=a),r&&(this.superState=r),"function"!==typeof Object(s.a)("core","edgehandles")&&s.a.use(i.a),"function"!==typeof Object(s.a)("core","nodeEditing")&&h()(s.a,u.a,d.a),"function"!==typeof Object(s.a)("core","gridGuide")&&o()(s.a),this.cy=Object(s.a)({...b.a,container:t}),this.id=e,this.projectName=n,this.authorName=p,this.cy.emit("graph-modified"),this.bendNode=this.cy.add({group:"nodes",data:{type:"bend"},classes:["hidden"]}),this.registerEvents(),this.cy.emit("graph-modified"),this.initizialize()}initizialize(){this.cy.nodeEditing({resizeToContentCueEnabled:()=>!1,setWidth(e,t){e.data("style",{...e.data("style"),width:t})},setHeight(e,t){e.data("style",{...e.data("style"),height:t})},isNoResizeMode:e=>"ordin"!==e.data("type"),isNoControlsMode:e=>"ordin"!==e.data("type")}),this.cy.gridGuide({snapToGridOnRelease:!1,zoomDash:!0,panGrid:!0}),this.cy.edgehandles({preview:!1,handlePosition:()=>"none",handleNodes:'node[type = "ordin"],node[type = "special"]',complete:(e,t,a)=>{a.remove(),this.addEdge({sourceID:e.id(),targetID:t.id()})}})}getById(e){return this.cy.getElementById(e)}getLabelFromID(e){return this.getById(e).data("label")||"**Deleted El**"}set(e){let{cy:t,dispatcher:a,superState:s,projectName:r,authorName:i}=e;a&&(this.dispatcher=a),s&&(this.superState=s),t&&(this.cy=t),r&&(this.projectName=r),i&&(this.authorName=i)}setProjectName(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.projectName=e,t&&this.dispatcher({type:g.a.SET_PROJECT_DETAILS,payload:{value:e,graphID:this.id,type:"projectName"}}),this.cy.emit("graph-modified")}setProjectAuthor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.authorName=e,t&&this.dispatcher({type:g.a.SET_AUTHOR,payload:{value:e,graphID:this.id,type:"authorName"}}),this.cy.emit("graph-modified")}setServerID(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.serverID=e,t&&this.dispatcher({type:g.a.SET_PROJECT_DETAILS,payload:{value:e,graphID:this.id,type:"serverID"}}),this.cy.emit("graph-modified")}selectDeselectEventHandler(){const e=this.cy.$(":selected");if(0===e.length)return this.dispatcher({type:g.a.ELE_UNSELECTED});let t;t=e.every((e=>e.isNode()))?"NODE":e.every((e=>e.isEdge()))?"EDGE":"MIX";const a=e.map((e=>e.data("id")));return this.dispatcher({type:g.a.ELE_SELECTED,payload:{ids:a,type:t}})}registerEvents(){this.cy.on("select unselect",(()=>this.selectDeselectEventHandler())),this.cy.on("grab",'node[type = "ordin"]',(e=>{e.target.forEach((e=>{e.scratch("position",{...e.position()})}))})),this.cy.on("nodeediting.resizestart",((e,t,a)=>{a.scratch("height",a.data("style").height),a.scratch("width",a.data("style").width),a.scratch("position",{...a.position()})})),this.cy.on("hide-bend remove",(()=>{this.bendNode.removeListener("drag grab dragfree"),this.bendNode.addClass("hidden")})),this.cy.on("grabon",(e=>"bend"!==e.target[0].data("type")?this.cy.emit("hide-bend"):0)),this.cy.on("freeon",(e=>"bend"!==e.target[0].data("type")?this.cy.emit("show-bend"):0)),this.cy.on("click tap",(e=>{e.target===this.cy&&(this.cy.emit("hide-bend"),this.cy.$(".eh-handle").remove())})),this.cy.on("select unselect show-bend",(()=>{const e=this.cy.$(":selected");return 1===e.length&&e[0].isEdge()||this.cy.emit("hide-bend"),e.emit("bend-edge")})),this.cy.on("mouseover","edge",(e=>{e.target.emit("bend-edge")})),this.cy.on("bend-edge","edge",(e=>{this.bendNode.hasClass("hidden")||this.cy.emit("hide-bend");const t=e.target;this.bendNode.position(m.getBendEdgePoint(t)),this.bendNode.on("drag",(()=>{const a=y.a.getWeightDistance(this.bendNode.position(),t.source().position(),t.target().position());t.data("bendData",{bendDistance:a.d,bendWeight:a.w}),e.target.emit("bending")})),this.bendNode.on("grab",(()=>{t.scratch("bendDistWeight",t.data("bendData"))})),this.bendNode.on("dragfree",(()=>{const e=t;this.addBendChange(e.id(),e.scratch("bendDistWeight"),t.data("bendData"))})),this.bendNode.removeClass("hidden")}))}setBendWightDist(e,t){this.getById(e).data("bendData",t)}static getBendEdgePoint(e){const{bendWeight:t,bendDistance:a}=e.data("bendData"),s=parseFloat(t),r=parseFloat(a);return y.a.getCoordinate(s,r,e.source().position(),e.target().position())}setCurStatus(){this.selectDeselectEventHandler()}reset(){this.resetAllComp(),this.resetAllAction()}}var E=m;t.a=class extends E{resetZoom(){this.cy.reset(),this.cy.center(),this.dispatcher({type:g.a.SET_ZOOM_LEVEL,payload:this.getZoom()})}setOnZoom(e){this.cy.removeListener("zoom"),this.setZoomUI=e,this.cy.on("zoom",(t=>e(Math.round(100*t.target.zoom()))))}fitZoom(){this.cy.fit(),this.dispatcher({type:g.a.SET_ZOOM_LEVEL,payload:this.getZoom()})}setZoom(e){this.cy.zoom(e/100)}getZoom(){return Math.round(100*this.cy.zoom())}clearAll(){return 0===this.cy.elements().length||!!window.confirm("Do want to clear all elements?")&&(this.cy.elements().forEach((e=>this.deleteElem(e.id(),0))),this.dispatcher({type:g.a.CHANGE_RESET,payload:!0}),this.cy.emit("graph-modified"),!0)}resetAllComp(){this.cy.elements().remove()}setCurStatus(){super.setCurStatus(),this.dispatcher({type:g.a.SET_ZOOM_LEVEL,payload:Math.round(100*this.cy.zoom())})}}},174:function(e,t,a){},176:function(e,t,a){},181:function(e,t,a){},187:function(e,t,a){},189:function(e,t,a){},190:function(e,t,a){},207:function(e,t){},209:function(e,t){},219:function(e,t,a){},272:function(e,t,a){},282:function(e,t,a){},284:function(e,t,a){},286:function(e,t,a){},287:function(e,t,a){},288:function(e,t,a){},289:function(e,t,a){},290:function(e,t,a){},31:function(e,t,a){"use strict";const s={ALL_GRAPHS:window.btoa("ALL_GRAPHS"),AUTHOR_NAME:window.btoa("AUTHOR_NAME"),allgs:(r=window.btoa("ALL_GRAPHS"),window.localStorage.getItem(r)||window.localStorage.setItem(r,window.btoa(JSON.stringify([]))),new Set(JSON.parse(window.atob(window.localStorage.getItem(r))))),saveAllgs(){window.localStorage.setItem(this.ALL_GRAPHS,window.btoa(JSON.stringify(Array.from(this.allgs))))},addEmptyIfNot(){window.localStorage.getItem(this.ALL_GRAPHS)||window.localStorage.setItem(this.ALL_GRAPHS,window.btoa(JSON.stringify([])))},get:e=>null===window.localStorage.getItem(e)?null:JSON.parse(window.atob(window.localStorage.getItem(e))),save(e,t){this.addGraph(e);const a=JSON.stringify(t);window.localStorage.setItem(e,window.btoa(a))},remove(e){this.allgs.delete(e)&&this.saveAllgs(),localStorage.removeItem(e)},addGraph(e){this.allgs.has(e)||(this.allgs.add(e),this.saveAllgs())},getAllGraphs(){return JSON.parse(window.atob(window.localStorage.getItem(this.ALL_GRAPHS)))},addToFront(e){if(this.allgs.has(e))return;this.allgs.add(e);const t=JSON.parse(window.atob(window.localStorage.getItem(this.ALL_GRAPHS)));t.unshift(e),window.localStorage.setItem(this.ALL_GRAPHS,window.btoa(JSON.stringify(t)))},getAuthorName(){return localStorage.getItem(this.AUTHOR_NAME)||""},setAuthorName(e){localStorage.setItem(this.AUTHOR_NAME,e)},clearGraph(e){window.localStorage.removeItem(e)},getFileList:()=>localStorage.getItem("fileList")||""};var r;t.a=s},332:function(e,t,a){},333:function(e,t,a){},336:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},341:function(e,t,a){"use strict";a.r(t);var s=a(1),r=a.n(s),i=a(27),n=a.n(i),o=(a(174),a(15)),l=(a(175),a(176),a(63)),d=a(158),c=a(109),h=(a(180),a(181),a(70)),p=a(7),u=a(2);const{minZoom:b,maxZoom:y}=h.a,g={};var m=e=>{let{superState:t,dispatcher:a}=e;const s=t.curGraphInstance;if(!s)return Object(u.jsx)(u.Fragment,{});const r=t.zoomLevel;return Object(u.jsx)("div",{children:Object(u.jsxs)("div",{className:"zoom-comp",children:[Object(u.jsx)("div",{role:"button",tabIndex:0,className:"zoom-box zoom-btn",onClick:()=>s.resetZoom(),onKeyDown:e=>" "===e.key&&s.resetZoom(),children:Object(u.jsx)(c.b,{})}),Object(u.jsx)("div",{role:"button",tabIndex:0,className:"zoom-box zoom-btn",onClick:()=>s.fitZoom(),onKeyDown:e=>" "===e.key&&s.resetZoom(),children:Object(u.jsx)(c.a,{})}),Object(u.jsxs)("div",{className:"zoom-box zoom-value",children:[r,"%"]}),Object(u.jsx)("div",{className:"slider",children:Object(u.jsx)(d.a,{min:100*b,max:100*y,marks:g,onChange:e=>{s.setZoom(e),a({type:p.a.SET_ZOOM_LEVEL,payload:e})},included:!1,value:r})})]})})},E=(a(190),a(31)),O=a(73),f=a(48),j=a(66),_=a.n(j);class S{constructor(e){this.arr=[e],this.flatenArr()}flatenArr(){const e=[];for(let t=0;t<this.arr.length;t+=1)this.arr[t].constructor===Array?this.arr[t].forEach((e=>this.arr.push(e))):e.push(this.arr[t]);this.arr=e}G(e){return new S(this.arr.map((t=>t[e])).filter((e=>e)))}S(e){return this.arr=this.arr.map((t=>t[e])).filter((e=>e)),this.flatenArr(),this}any(){const e=[];return this.arr.forEach((t=>{Object.keys(t).forEach((a=>{e.push(t[a])}))})),this.arr=e,this.flatenArr(),this}parseProps(e,t){const a=new S(this.arr);return e.split(".").forEach((e=>"*"===e?a.any():a.S(e))),1===t?a.A():2===t?a:a.F()}A(){return this.arr}F(){return this.arr[0]}}var v=S;const x=(e,t,a)=>t.includes(e)?e:a,D=e=>{const t=new v(e).parseProps("data.y:ShapeNode",2);return{label:t.parseProps("y:NodeLabel._")||t.parseProps("y:NodeLabel"),id:new v(e).parseProps("$.id"),position:{x:parseFloat(t.parseProps("y:Geometry.$.x")),y:parseFloat(t.parseProps("y:Geometry.$.y"))},style:{width:parseFloat(t.parseProps("y:Geometry.$.width")),height:parseFloat(t.parseProps("y:Geometry.$.height")),opacity:parseInt(t.parseProps("y:Fill.$.opacity"),10)||1,shape:x(t.parseProps("y:Shape.$.type"),["rectangle","ellipse"],"rectangle"),backgroundColor:t.parseProps("y:Fill.$.color"),borderColor:t.parseProps("y:BorderStyle.$.color"),borderWidth:parseInt(t.parseProps("y:BorderStyle.$.width"),10)}}},N=e=>({label:new v(e).parseProps("data.*.y:EdgeLabel._")||new v(e).parseProps("data.*.y:EdgeLabel"),source:new v(e).parseProps("$.source"),target:new v(e).parseProps("$.target"),style:{backgroundColor:new v(e).parseProps("data.*.y:LineStyle.$.color"),thickness:parseFloat(new v(e).parseProps("data.*.y:LineStyle.$.width")),shape:x(new v(e).parseProps("data.*.y:LineStyle.$.type"),["dashed","dotted"],"solid")},bendData:{bendPoint:new v(e).parseProps("data.*.y:Path.y:Point.$")}}),I=e=>{let{actionName:t,parameters:a}=e;return{actionName:t[0],parameters:a[0]}};var A=e=>new Promise((t=>{(new _.a.Parser).parseString(e,((e,a)=>{const s=new v(a),r=s.parseProps("graphml.graph.node",1).map(D),i=s.parseProps("graphml.graph.edge",1).map(N),{id:n,projectName:o,serverID:l,authorName:d}=(e=>e.parseProps("graphml.graph.$"))(s),c=(e=>e.parseProps("graphml.graph.actionHistory",1).map((e=>{let{equivalent:t,inverse:a,tid:s}=e;return{equivalent:I(t[0]),inverse:I(a[0]),tid:s[0]}})))(s);t({id:n,projectName:o,edges:i,nodes:r,actionHistory:c,serverID:l,authorName:d})}))}));const T=e=>e.curGraphInstance,w=(e,t)=>{t({type:p.a.Model_Open_Create_Node,cb:(t,a)=>{const s=T(e).validiateNode(t,a,null,"New");return s.ok&&T(e).addNode(t,a),s}})},C=(e,t)=>{const a=1===e.eleSelectedPayload.ids.length,s=(new Date).getTime();"NODE"===e.eleSelectedPayload.type&&t({type:p.a.Model_Open_Update_Node,cb:(t,r)=>{const i={ok:!0,err:null};return e.eleSelectedPayload.ids.forEach((s=>{const n=T(e).validiateNode(a?t:null,r,s,"Update");i.ok=i.ok&&n.ok,i.err=i.err||n.err})),i.ok&&e.eleSelectedPayload.ids.forEach((i=>T(e).updateNode(i,r,t,a,s))),i},labelAllowed:a,label:T(e).getLabel(e.eleSelectedPayload.ids[0]),style:T(e).getStyle(e.eleSelectedPayload.ids[0])}),"EDGE"===e.eleSelectedPayload.type&&t({type:p.a.Model_Open_Update_Edge,cb:(t,r)=>{const i={ok:!0,err:null};return e.eleSelectedPayload.ids.forEach((s=>{const n=T(e).validiateEdge(a?t:null,r,null,null,s,"Update");i.ok=i.ok&&n.ok,i.err=i.err||n.err})),i.ok&&e.eleSelectedPayload.ids.forEach((i=>T(e).updateEdge(i,r,t,a,s))),i},labelAllowed:a,label:T(e).getLabel(e.eleSelectedPayload.ids[0]),style:T(e).getStyle(e.eleSelectedPayload.ids[0])})},L=(e,t,a)=>{T(e).downloadImg(a)};async function G(e){if(e.curGraphInstance){const t=e.graphs[e.curGraphIndex];if(t.fileHandle){const a=await t.fileHandle.createWritable();await a.write(T(e).saveToFolder()),await a.close(),o.b.success("File saved Successfully")}else t.fileHandle?o.b.info("Switch to Edge/Chrome!"):T(e).saveWithoutFileHandle()}else o.b.info("Switch to Edge/Chrome!")}const k=async(e,t,a,s)=>{if(a){const e=new FileReader,r=a.name;"graphml"===a.name.split(".").pop()&&(e.onload=e=>{A(e.target.result).then((i=>{let{authorName:n}=i;t({type:p.a.ADD_GRAPH,payload:{projectName:r,graphML:e.target.result,fileHandle:s,fileName:a.name,authorName:n}})}))},s?e.readAsText(await s.getFile()):e.readAsText(a))}},M=(e,t,a,s)=>{a&&t({type:p.a.EDIT_TEXTFILE,payload:{show:!0,fileObj:a,fileHandle:s}})},P=(e,t)=>{t({type:p.a.EDIT_TEXTFILE,payload:{show:!0}})},R=(e,t)=>{t({type:p.a.NEW_GRAPH})},B=e=>{T(e).clearAll()},F=(e,t)=>{t({type:p.a.SET_CONTRIBUTE_MODAL,payload:!0})},W=e=>{T(e).resetAfterClear()},U=(e,t)=>{t({type:p.a.SET_LOGS,payload:!e.logs})},H=e=>{T(e)&&T(e).undo()},$=e=>{T(e).redo()},z=(e,t)=>{t({type:p.a.SET_HISTORY_MODAL,payload:!0})};a(219);var V=e=>{let{superState:t,dispatcher:a}=e;const s=(e,s)=>{s.stopPropagation(),window.confirm("Do you confirm to close the tab? This action is irreversable.")&&(E.a.remove(t.graphs[e]?t.graphs[e].graphID:null),a({type:p.a.REMOVE_GRAPH,payload:e}),t.curGraphIndex||1!==t.graphs.length||(a({type:p.a.SET_CUR_INSTANCE,payload:null}),a({type:p.a.SET_CUR_INDEX,payload:-1})))},i=e=>{e.stopPropagation(),a({type:p.a.SET_EDIT_DETAILS_MODAL,payload:!0})};return r.a.useEffect((()=>{Object(f.a)("ctrl+shift+m,command+shift+m",(e=>{e.preventDefault(),document.getElementById("new_graph").click()})),Object(f.a)("ctrl+shift+e,command+shift+e",(e=>{e.preventDefault();const t=document.querySelector(".tab.tab-graph.selected > .tab-act.edit");t&&t.click()})),Object(f.a)("ctrl+shift+l,command+shift+l",(e=>{e.preventDefault();const t=document.querySelector(".tab.tab-graph.selected > .tab-act.close");t&&t.click()}))}),[]),Object(u.jsxs)("div",{className:"tab-par",children:[Object(u.jsx)("button",{className:"tab",onClick:R.bind(void 0,t,a),type:"button",id:"new_graph","data-tip":"New Workflow Tab (Ctrl + Shift + M)",children:Object(u.jsx)(O.a,{size:25})}),t.graphs.map(((e,r)=>Object(u.jsxs)("div",{className:"tab tab-graph "+(t.curGraphIndex===r?"selected":"none"),onClick:()=>a({type:p.a.CHANGE_TAB,payload:r}),onKeyDown:e=>" "===e.key&&a({type:p.a.CHANGE_TAB,payload:r}),role:"button",tabIndex:0,id:`tab_${r}`,children:[Object(u.jsx)("span",{className:"tab-text",children:e.fileName||e.projectName}),t.curGraphIndex===r?Object(u.jsx)("button",{className:"tab-act edit",onClick:i,type:"button","data-tip":"Edit Workflow Details (Ctrl + Shift + E)","data-for":"header-tab",children:Object(u.jsx)(O.c,{size:16})}):Object(u.jsx)(u.Fragment,{}),Object(u.jsx)("button",{className:"tab-act close",onClick:s.bind(void 0,r),type:"button","data-tip":"Close current Workflow (Ctrl + Shift + L)","data-for":"header-tab",children:Object(u.jsx)(O.b,{size:20})}),Object(u.jsx)(l.a,{place:"bottom",type:"dark",effect:"solid",id:"header-tab"})]},e.graphID)))]})};var K=a(360),q=a(49);var J=e=>{let{label:t,id:a,posX:s,posY:r,width:i,height:n,opacity:o,shape:l,backgroundColor:d,borderColor:c,borderWidth:h}=e;return{$:{id:a},data:[{$:{key:"d6"},"y:ShapeNode":[{"y:Geometry":[{$:{height:n,width:i,x:s,y:r}}],"y:Fill":[{$:{color:d,opacity:o}}],"y:BorderStyle":[{$:{color:c,width:h}}],"y:NodeLabel":[t],"y:Shape":[{$:{type:l}}]}]}]}};var Z=e=>{let{nodes:t,edges:a,id:s,projectName:r,authorName:i,actionHistory:n,serverID:o,fileHandle:l,fileName:d}=e;return{graphml:{$:{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml"},key:[{$:{for:"node",id:"d6","yfiles.type":"nodegraphics"}},{$:{for:"edge",id:"d10","yfiles.type":"edgegraphics"}}],graph:[{$:{edgedefault:"directed",id:s,projectName:r,serverID:o,fileHandle:l,fileName:d,authorName:i},node:t,edge:a,actionHistory:n}]}}};var X=e=>{let{id:t,label:a,source:s,target:r,lineColor:i,lineWidth:n,bendPoint:o,type:l}=e;return{$:{id:t,source:s,target:r},data:[{$:{key:"d10"},"y:GenericEdge":[{$:{configuration:"com.yworks.bpmn.Connection"},"y:LineStyle":[{$:{color:i,width:n,type:l}}],"y:Arrows":[{$:{source:"none",target:"delta"}}],"y:EdgeLabel":[a],"y:Path":[{$:{sx:"0.0",sy:"0.0",tx:"0.0",ty:"0.0"},"y:Point":[{$:o}]}]}]}]}};var Y=e=>{const t=e.nodes.map((e=>J({label:e.label,id:e.id,posX:e.position.x,posY:e.position.y,...e.style}))),a=e.edges.map(((e,t)=>X({id:t,label:e.label,source:e.source,target:e.target,lineColor:e.style.backgroundColor,lineWidth:e.style.thickness,bendPoint:e.bendData.bendPoint,type:e.style.shape}))),s=Z({nodes:t,edges:a,projectName:e.projectName,id:e.id,actionHistory:e.actionHistory,serverID:e.serverID,fileHandle:e.fileHandle,fileName:e.fileName,authorName:e.authorName});return(new _.a.Builder).buildObject(s)},Q=a(45),ee=a(144),te=a.n(ee),ae=a(145),se=a(14);class re extends ae.a{constructor(){var e;super(...arguments),e=this,this.methodsMapped={[se.a.ADD_NODE]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.addNode(...a,0)},[se.a.ADD_EDGE]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.addEdge(...a,0)},[se.a.UPDATE_NODE]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.updateNode(...a,0)},[se.a.UPDATE_EDGE]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.updateEdge(...a,0)},[se.a.UPDATE_DATA]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.updateData(...a,0)},[se.a.DEL_NODE]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.deleteNode(...a,0)},[se.a.DEL_EDGE]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.deleteElem(...a,0)},[se.a.SET_POS]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.setPos(...a,0)},[se.a.SET_DIM]:function(){for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];return e.setDim(...a,0)},[se.a.SET_BENDW]:function(){return e.setBendWightDist(...arguments)}},this.actionArr=[],this.curActionIndex=0}resetAllAction(){this.actionArr=[],this.curActionIndex=0}informUI(){this.dispatcher({type:p.a.SET_UNDO,payload:0!==this.curActionIndex}),this.dispatcher({type:p.a.SET_REDO,payload:this.curActionIndex!==this.actionArr.length})}performAction(e){let{actionName:t,parameters:a}=e;(0,this.methodsMapped[t])(...a)}addPositionChange(e,t,a){const s=(new Date).getTime();this.addAction({actionName:se.a.SET_POS,parameters:[e,t,a]},{actionName:se.a.SET_POS,parameters:[e,a,t]},s)}addDimensionChange(e,t,a,s,r){const i=(new Date).getTime();this.addAction({actionName:se.a.SET_DIM,parameters:[e,t,a]},{actionName:se.a.SET_DIM,parameters:[e,s,r]},i)}addBendChange(e,t,a){const s=(new Date).getTime();this.addAction({actionName:se.a.SET_BENDW,parameters:[e,t]},{actionName:se.a.SET_BENDW,parameters:[e,a]},s)}static sequencify(e){if(!(e instanceof Object))return e;let t=[];return e instanceof Array?t=e.map(re.sequencify):Object.keys(e).sort().forEach((a=>{t.push(`:${a}:`),t.push(re.sequencify(e[a]))})),t}addAction(e,t,a){if(0===a)return;this.actionArr.splice(this.curActionIndex);const s=re.sequencify(t).toString()+re.sequencify(t).toString()+a;this.actionArr.push({tid:a,inverse:e,equivalent:t,hash:te()(`${s}|${this.actionArr.length?this.actionArr.at(-1).hash:""}`)}),this.curActionIndex+=1,this.informUI()}undoSingleAction(){0!==this.curActionIndex&&(this.curActionIndex-=1,this.performAction(this.actionArr[this.curActionIndex].inverse),this.informUI())}redoSingleAction(){this.curActionIndex!==this.actionArr.length&&(this.performAction(this.actionArr[this.curActionIndex].equivalent),this.curActionIndex+=1,this.informUI())}undo(){let e=null;for(0!==this.curActionIndex&&(e=this.actionArr[this.curActionIndex-1].tid);0!==this.curActionIndex&&this.actionArr[this.curActionIndex-1].tid===e;)this.curActionIndex-=1,this.performAction(this.actionArr[this.curActionIndex].inverse);this.informUI()}redo(){let e=null;for(this.curActionIndex!==this.actionArr.length&&(e=this.actionArr[this.curActionIndex].tid);this.curActionIndex!==this.actionArr.length&&this.actionArr[this.curActionIndex].tid===e;)this.performAction(this.actionArr[this.curActionIndex].equivalent),this.curActionIndex+=1;this.informUI()}resetAfterClear(){const e=this.curActionIndex;for(this.curActionIndex=0;this.curActionIndex!==this.actionArr.length&&this.curActionIndex!==e;)this.performAction(this.actionArr[this.curActionIndex].equivalent),this.curActionIndex+=1;return this.informUI(),this.dispatcher({type:p.a.CHANGE_RESET,payload:!1}),!0}setCurStatus(){super.setCurStatus(),this.informUI()}registerEvents(){super.registerEvents(),this.cy.on("dragfree",'node[type = "ordin"]',(e=>{e.target.forEach((e=>{this.addPositionChange(e.id(),e.scratch("position"),{...e.position()})}))})),this.cy.on("nodeediting.resizeend",((e,t,a)=>{this.addDimensionChange(a.id(),{height:a.scratch("height"),width:a.scratch("width")},a.scratch("position"),{height:a.data("style").height,width:a.data("style").width},{...a.position()})}))}}var ie=re;class ne extends ie{constructor(){super(...arguments),this.autoSaveIntervalId=null}registerEvents(){super.registerEvents(),this.cy.on("add remove data dragfreeon",'node[type="ordin"]',(()=>this.saveLocalStorage())),this.cy.on("add remove data",'edge[type="ordin"]',(()=>this.saveLocalStorage())),this.cy.on("nodeediting.resizeend graph-modified",(()=>this.saveLocalStorage()))}downloadImg(e){this.cy.emit("hide-bend"),this.cy.$(".eh-handle").remove(),"PNG"===e&&Object(q.saveAs)(this.cy.png({full:!0}),`${this.getName()}-DHGWorkflow.png`),"JPG"===e&&Object(q.saveAs)(this.cy.jpg({full:!0}),`${this.getName()}-DHGWorkflow.jpg`)}shouldNodeBeSaved(e){return"ordin"===this.getById(e).data("type")}shouldEdgeBeSaved(e){return"ordin"===this.getById(e).data("type")}getRealSourceId(e){return e}static stringifyAction(e){let{actionName:t,parameters:a}=e;return{actionName:t,parameters:window.btoa(JSON.stringify(a))}}static parseAction(e){let{actionName:t,parameters:a}=e;return{actionName:t,parameters:JSON.parse(window.atob(a))}}jsonifyGraph(){const e={nodes:[],edges:[],actionHistory:[],projectName:this.projectName,id:this.id,serverID:this.serverID,fileName:null,fileHandle:null,authorName:this.authorName};return this.cy.nodes().forEach((t=>{if(this.shouldNodeBeSaved(t.id())){const a=t.json(),s={label:a.data.label,id:a.data.id,position:a.position,style:{}};s.style=this.getStyle(t.id()),e.nodes.push(s)}})),this.cy.edges().forEach((t=>{if(this.shouldEdgeBeSaved(t.id())){const a=t.json().data;a.source=this.getRealSourceId(t.source().id()),a.style=this.getStyle(t.id()),a.bendData.bendPoint=Q.a.getCoordinate(a.bendData.bendWeight,a.bendData.bendDistance,t.source().position(),t.target().position()),e.edges.push(a)}})),e.actionHistory=this.actionArr.map((e=>{let{tid:t,inverse:a,equivalent:s,hash:r}=e;return{tid:t,inverse:ne.stringifyAction(a),equivalent:ne.stringifyAction(s),hash:r}})),e}getName(){return`${this.projectName}`}async saveToDisk(){const e=Y(this.jsonifyGraph()),t=(new TextEncoder).encode(e),a=new Blob([t],{type:"application/json;charset=utf-8"});if(-1!==navigator.userAgent.indexOf("Edg")||-1!==navigator.userAgent.indexOf("Chrome")){const e={types:[{description:"GraphMl Files",accept:{"text/graphml":[".graphml"]}}]},t=await window.showSaveFilePicker(e),s=await t.createWritable();await s.write(a),await s.close();const r=await t.getFile();let i=this.superState.fileState;i=i.concat([{key:`${this.superState.uploadedDirName}/${t.name}`,modified:r.lastModified,size:r.size,fileObj:r,fileHandle:t}]),this.dispatcher({type:p.a.SET_FILE_STATE,payload:i})}else{const e=prompt("Filename:");Object(q.saveAs)(a,`${e||`${this.getName()}-concore`}.graphml`)}o.b.success("File saved Successfully")}async saveWithoutFileHandle(){const{userAgent:e}=navigator;if(e.match(/firefox|fxios/i))return void o.b.info("Switch to Edge/Chrome!");const t=Y(this.jsonifyGraph()),a=(new TextEncoder).encode(t),s=new Blob([a],{type:"application/json;charset=utf-8"}),r=await window.showSaveFilePicker({types:[{description:"GraphMl Files",accept:{"text/graphml":[".graphml"]}}]});this.dispatcher({type:p.a.SET_FILE_HANDLE,payload:{curGraphIndex:this.superState.curGraphIndex,fileHandle:r}});const i=await r.createWritable();await i.write(s),await i.close(),o.b.success("File saved Successfully")}saveToFolder(){return Y(this.jsonifyGraph())}getGraphML(){return Y(this.jsonifyGraph())}loadJson(e){e.nodes.forEach((e=>{this.addNode(e.label,e.style,"ordin",e.position,{},e.id,0)})),e.edges.forEach((e=>{this.addEdge({...e,sourceID:e.source,targetID:e.target},0)})),e.actionHistory.forEach((e=>{let{inverse:t,equivalent:a,tid:s}=e;this.addAction(ne.parseAction(t),ne.parseAction(a),s)})),this.setProjectName(e.projectName),this.setServerID(this.serverID||e.serverID),this.setProjectAuthor(e.authorName)}saveLocalStorage(){null!==this.autoSaveIntervalId&&clearTimeout(this.autoSaveIntervalId),this.autoSaveIntervalId=setTimeout((()=>E.a.save(this.id,this.jsonifyGraph())),1e3)}setGraphML(e){A(e).then((e=>{E.a.save(this.id,e),this.loadGraphFromLocalStorage()}))}resetLocalStorage(){E.a.clearGraph(this.id)}loadGraphFromLocalStorage(){this.reset();const e=E.a.get(this.id);return!!e&&(this.loadJson(e),!0)}serializeGraph(){return window.btoa(JSON.stringify(this.jsonifyGraph()))}}var oe=ne;var le=class extends oe{set(e){const{serverID:t}=e;super.set(e),t&&(this.setServerID(t),this.dispatcher({type:p.a.IS_WORKFLOW_ON_SERVER,payload:Boolean(this.serverID)}))}build(){const e=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});this.dispatcher({type:p.a.SET_LOGS,payload:!1}),K.a.post(`http://127.0.0.1:5000/build/${this.superState.uploadedDirName}?fetch=${this.superState.graphs[this.superState.curGraphIndex].fileName.split(".")[0]}&unlock=${this.superState.unlockCheck}&docker=${this.superState.dockerCheck}&maxtime=${this.superState.maxTime}&params=${this.superState.params}&octave=${this.superState.octave}`).then((t=>{o.b.success(t.data.message),this.dispatcher({type:p.a.SET_FUNCTIONS,payload:{built:!1,ran:!0,debugged:!0,cleared:!1,stopped:!1,destroyed:!0}}),this.dispatcher({type:p.a.SET_LOGS_MESSAGE,payload:this.superState.logsmessage+t.data.output}),o.b.dismiss(e)})).catch((t=>{o.b.error(t.message),o.b.dismiss(e)})),this.serverID}debug(){const e=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});this.dispatcher({type:p.a.SET_LOGS,payload:!1}),K.a.post(`http://127.0.0.1:5000/debug/${this.superState.graphs[this.superState.curGraphIndex].fileName.split(".")[0]}`).then((t=>{o.b.success(t.data.message),this.dispatcher({type:p.a.SET_FUNCTIONS,payload:{built:!1,ran:!1,debugged:!1,cleared:!0,stopped:!0,destroyed:!0}}),o.b.dismiss(e)})).catch((t=>{o.b.error(t.message),o.b.dismiss(e)})),this.serverID}run(){const e=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});this.dispatcher({type:p.a.SET_LOGS,payload:!1}),K.a.post(`http://127.0.0.1:5000/run/${this.superState.graphs[this.superState.curGraphIndex].fileName.split(".")[0]}`).then((t=>{o.b.success(t.data.message),this.dispatcher({type:p.a.SET_FUNCTIONS,payload:{built:!1,ran:!1,debugged:!1,cleared:!0,stopped:!0,destroyed:!0}}),o.b.dismiss(e)})).catch((t=>{o.b.error(t.message),o.b.dismiss(e)})),this.serverID}clear(){const e=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});this.dispatcher({type:p.a.SET_LOGS,payload:!1}),K.a.post(`http://127.0.0.1:5000/clear/${this.superState.graphs[this.superState.curGraphIndex].fileName.split(".")[0]}\n        ?unlock=${this.superState.unlockCheck}&maxtime=${this.superState.maxTime}&params=${this.superState.params}`).then((t=>{o.b.success(t.data.message),this.dispatcher({type:p.a.SET_FUNCTIONS,payload:{built:!1,ran:!0,debugged:!0,cleared:!1,stopped:!0,destroyed:!0}}),o.b.dismiss(e)})).catch((t=>{o.b.error(t.message),o.b.dismiss(e)})),this.serverID}stop(){const e=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});this.dispatcher({type:p.a.SET_LOGS,payload:!1}),K.a.post(`http://127.0.0.1:5000/stop/${this.superState.graphs[this.superState.curGraphIndex].fileName.split(".")[0]}`).then((t=>{o.b.success(t.data.message),this.dispatcher({type:p.a.SET_FUNCTIONS,payload:{built:!1,ran:!1,debugged:!1,cleared:!0,stopped:!1,destroyed:!0}}),o.b.dismiss(e)})).catch((t=>{o.b.error(t.message),o.b.dismiss(e)})),this.serverID}destroy(){const e=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});this.dispatcher({type:p.a.SET_LOGS,payload:!1}),K.a.delete(`http://127.0.0.1:5000/destroy/${this.superState.graphs[this.superState.curGraphIndex].fileName.split(".")[0]}`).then((t=>{o.b.success(t.data.message),this.dispatcher({type:p.a.SET_FUNCTIONS,payload:{built:!0,ran:!1,debugged:!1,cleared:!1,stopped:!1,destroyed:!1}}),o.b.dismiss(e)})).catch((t=>{o.b.error(t.message),o.b.dismiss(e)})),this.serverID}library(e){const t=o.b.info("LOADING.......",{position:"bottom-left",autoClose:!1});K.a.post(`http://127.0.0.1:5000/library/${this.superState.uploadedDirName}?filename=${e}&path=${this.superState.library}`).then((e=>{o.b.info(e.data.message),o.b.dismiss(t)})).catch((e=>{o.b.error(e.message),o.b.dismiss(t)})),this.serverID}setCurStatus(){super.setCurStatus(),this.dispatcher({type:p.a.IS_WORKFLOW_ON_SERVER,payload:Boolean(this.serverID)})}};const de={getEq(e,t){const a=(e.y-t.y)/(e.x-t.x);return[a,e.y-a*e.x]},getX1X2(e,t,a,s){if(e.x===t.x)return[t.x,t.x];const r={x:t.x-e.x,y:t.y-e.y},[i,n]=this.getEq({x:0,y:0},r),o=a**2*i**2+s**2,l=2*a**2*i*n,d=l**2-4*o*(a**2*(n**2-s**2));return[(-l+d**.5)/(2*o)+e.x,(-l-d**.5)/(2*o)+e.x]},getY1Y2(e,t,a,s,r,i){if(r===i)return[e.y+s,e.y-s];const[n,o]=this.getEq(e,t);return[n*r+o,n*i+o]},dist:(e,t)=>((e.x-t.x)**2+(e.y-t.y)**2)**.5,getClosestEllipse(e,t,a,s){const[r,i]=this.getX1X2(e,t,a,s),[n,o]=this.getY1Y2(e,t,a,s,r,i),[l,d]=[this.dist(t,{x:r,y:n}),this.dist(t,{x:i,y:o})];return l<d?{x:r,y:n}:{x:i,y:o}},slope:(e,t,a,s)=>(e-a)/(t-s),setSubQ(e,t,a,s){const[r,i]=[[e.x+a,e.y+s],[e.x+a,e.y-s]].map((a=>{let[s,r]=a;return(e.x-s)*(t.y-r)-(e.y-r)*(t.x-s)>0}));return r&&!i?0:r||i?!r&&i?2:r&&i?3:-1:1},getClosestRect(e,t,a,s){const[r,i]=this.getEq(t,e);let n=[[e.x+a,e.y],[e.x,e.y+s],[e.x-a,e.y],[e.x,e.y-s]];Math.abs(r)!==1/0&&(n=[[e.x+a,r*(e.x+a)+i],[(e.y+s-i)/r,e.y+s],[e.x-a,r*(e.x-a)+i],[(e.y-s-i)/r,e.y-s]]);const[o,l]=n[this.setSubQ(e,t,a,s)];return{x:o,y:l}},get:(e,t,a,s,r)=>"rectangle"===r?de.getClosestRect(e,t,a,s):de.getClosestEllipse(e,t,a,s)};var ce=de.get;class he extends le{registerEvents(){super.registerEvents(),this.cy.on("drag data moved",'node[type="ordin"]',(e=>{e.target.connectedEdges().connectedNodes('node[type="special"]').forEach((e=>{e.position(he.calJuncNodePos(e))}))})),this.cy.on("bending",(e=>{const t=e.target.source();t.position(he.calJuncNodePos(t))}))}static calJuncNodePos(e){const t=e.incomers("node")[0],a={x:0,y:0},s=new Set;return e.outgoers('edge[type="ordin"]').forEach((e=>s.add(JSON.stringify(he.getBendEdgePoint(e))))),s.forEach((e=>{const t=JSON.parse(e);a.x+=t.x,a.y+=t.y})),0===s.size?e.position():(a.x/=s.size,a.y/=s.size,ce(t.position(),a,t.data("style").width/2,t.data("style").height/2,t.data("style").shape))}getRealNode(e){return this.getById(e).incomers().filter("node")[0]}addAutoMove(e){return e.unselectify(),this}addEdgeWithJuncNode(e,t){const a=this.getById(e.sourceID),s=super.addEdge({...e,label:a.data("edgeLabel"),style:a.data("edgeStyle")},t);return a.position(he.calJuncNodePos(a)),s}addEdgeWithoutJuncNode(e,t){const{sourceID:a,targetID:s,style:r}=e,[i,n]=[a,s].map(this.getById.bind(this)),o=i.data("style"),l=ce(i.position(),n.position(),o.width/2,o.height/2,o.shape),d=super.addNode("",{backgroundColor:r.backgroundColor},"special",l,{edgeLabel:e.label,edgeStyle:r},void 0,t);return d.ungrabify(),super.addEdge({sourceID:a,targetID:d.id(),style:{...r,"target-arrow-shape":"none"},type:"special"},t),this.addAutoMove(d,i),this.addEdgeWithJuncNode({...e,sourceID:d.id()},t)}addEdgeAction(e,t,a){this.addAction({actionName:se.a.DEL_EDGE,parameters:[e]},{actionName:se.a.ADD_EDGE,parameters:[{...t,sourceID:this.getRealSourceId(t.sourceID),id:e}]},a)}addEdge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();const{sourceID:a,targetID:s,label:r}=e,[i,n]=[a,s].map(this.getById.bind(this)),o=i.outgoers("node").filter((e=>r&&e.data("edgeLabel")===r));let l;return"ordin"!==n.data("type")||("special"===i.data("type")?l=this.addEdgeWithJuncNode(e,0):o.length?l=this.addEdgeWithJuncNode({...e,sourceID:o[0].id()},0):r&&r.length?l=this.addEdgeWithoutJuncNode(e,0):this.dispatcher({type:p.a.Model_Open_Create_Edge,cb:(r,i)=>{const n=this.validiateEdge(r,i,a,s,null,"New");return n.ok&&(l=this.addEdge({...e,label:r,style:i},0)),l&&this.addEdgeAction(l.id(),{...e,label:r,style:i},t),n}}),l&&this.addEdgeAction(l.id(),e,t)),l}updateEdge(e,t,a,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getTid();this.addAction({actionName:se.a.UPDATE_EDGE,parameters:[e,this.getStyle(e),this.getById(e).data("label"),s]},{actionName:se.a.UPDATE_EDGE,parameters:[e,t,a,s]},r);const i=this.getById(e).source();s&&this.updateData(i.data("id"),"edgeLabel",a,0),this.updateData(i.data("id"),"edgeStyle",t,0),this.updateNode(i.data("id"),{backgroundColor:t.backgroundColor},"",!1,0),i.outgoers("edge").forEach((e=>super.updateEdge(e.data("id"),t,a,s,0)))}deleteElem(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getTid();const a=this.getById(e);if(a.isNode()){if(a.removed())return;a.outgoers('node[type="special"]').connectedEdges('edge[type="ordin"]').forEach((e=>this.deleteElem(e.id(),t))),a.connectedEdges('edge[type="ordin"]').forEach((e=>this.deleteElem(e.id(),t)));const s=this.getById(e);this.addAction({actionName:se.a.ADD_NODE,parameters:[s.data("label"),this.getStyle(s.id()),s.data("type"),s.position(),s.json().data,e]},{actionName:se.a.DEL_NODE,parameters:[e]},t),super.deleteNode(e,0)}else{if(!this.getById(e).length||a.removed())return;const s=this.getById(e).json().data;this.addAction({actionName:se.a.ADD_EDGE,parameters:[{...s,sourceID:this.getRealSourceId(s.source),targetID:s.target}]},{actionName:se.a.DEL_EDGE,parameters:[e]},t);const r=a.source();super.deleteEdge(e,0),r&&0===r.outgoers().length&&this.deleteNode(r.id(),0)}}getRealSourceId(e){return"ordin"===this.getById(e).data("type")||0===this.getById(e).incomers("node").length?e:this.getById(e).incomers("node")[0].id()}getEdgesBetweenNodes(e,t){const[a,s]=[e,t].map((e=>this.getById(this.getRealSourceId(e)))).map((e=>e.outgoers('node[type="special"]').union(e)));return a.edgesWith(s)}getNodesEdges(){const e=this.cy.$('node[type="ordin"]').map((e=>({label:e.data("label"),style:e.data("style"),id:e.data("id")}))),t={};return this.cy.$('edge[type="ordin"]').forEach((e=>{const a=e.data("label"),s=this.getById(this.getRealSourceId(e.source().id())).data("label"),r=e.target().data("label"),i=e.data("style"),n=e.data("id");t[a]?t[a].targetLabel.push(r):t[a]={targetLabel:[r],sourceLabel:s,id:n,label:a,style:i}})),[e,Object.values(t)]}}var pe=he;var ue=function(e){let{el:t,superState:a,dispatcher:r,graphID:i,serverID:n,graphML:o,projectName:l,graphContainerRef:d,active:c,authorName:h}=e;const[b,y]=Object(s.useState)(null),g=Object(s.useRef)(),m=e=>{if(e){const t=e;t.style.width=d.current.offsetWidth-2+"px",t.style.height=d.current.offsetHeight-2+"px"}};Object(s.useEffect)((()=>b&&b.set({superState:a})),[b,a]),Object(s.useEffect)((()=>c&&b&&b.setCurStatus()),[c&&b]),Object(s.useEffect)((()=>{c&&b&&r({type:p.a.SET_CUR_INSTANCE,payload:b})}),[c&&b]),Object(s.useEffect)((()=>{g.current&&(m(g.current),window.addEventListener("resize",(()=>m(g.current))),y((()=>{const e=new pe(i,g.current,r,a,l,"(node, nodes, edges) => {\n    var regex = /^[A-za-z0-9]+[:[A-Za-z0-9.]+]|[^$]$/;\n    let message = { ok: true, err: null };\n    if (!regex.test(node.label)) {\n        message = {\n            ok: false,\n            err: 'Node with incorrect label.',\n        }\n        return message;\n    }\n    nodes.forEach((n) => {\n        if (n.id !== node.id && n.label.split(':')[0] === node.label.split(':')[0]) {\n            message = {\n                ok: false,\n                err: 'Node with same label exists.',\n            };\n        }\n    });\n    return message;\n    }",'(edge, nodes, edges) => {\nlet message = { ok: true, err: null };\nlet numEdge = "";\nfor (let char of edge.label) {\n    if (!isNaN(parseInt(char))) {\n      numEdge += char;\n    } else if (numEdge !== "") {\n      break;\n    }\n}\nedges.forEach((e) => {\n    if (e.label === edge.label && e.sourceLabel !== edge.sourceLabel) {\n        message = {\n            ok: false,\n            err: \'Edge with same label exists.\',\n        };\n    }\n    let numE = "";\n    for (let char of e.label) {\n        if (!isNaN(parseInt(char))) {\n        numE += char;\n        } else if (numE !== "") {\n        break;\n        }\n    }\n    if (numE === numEdge && numE != "0" && numE !== "") {\n        message = {\n            ok: false,\n            err: \'2 edges cannot have same prefixes if they are number\',\n        };\n        return message;\n    }\n});\nreturn message;\n}',h);return i&&e.loadGraphFromLocalStorage(),n&&(e.set({serverID:n}),e.forcePullFromServer()),o&&e.setGraphML(o),e.setCurStatus(),e})()))}),[g]);const{id:E}=t;return Object(u.jsx)("div",{style:{zIndex:1,display:c?"block":"none"},className:"graph-element",ref:g},E)};var be=e=>{const t=r.a.useRef(),{dispatcher:a,superState:i}=e;return Object(s.useEffect)((()=>{const e=E.a.getAllGraphs().map((e=>({graphID:e})));a({type:p.a.ADD_GRAPH_BULK,payload:e})}),[]),Object(u.jsxs)("div",{style:{flex:1,flexDirection:"column",display:"flex",width:"100%"},children:[Object(u.jsx)(V,{superState:i,dispatcher:a}),Object(u.jsxs)("div",{style:{flex:1,background:"white"},className:"graph-container",ref:t,children:[i.graphs.map(((e,s)=>Object(u.jsx)(ue,{el:e,i:s,superState:i,graphContainerRef:t,dispatcher:a,active:s===i.curGraphIndex,graphID:e.graphID,serverID:e.serverID,graphML:e.graphML,projectName:e.projectName,fileHandle:e.fileHandle,fileName:e.fileName,authorName:e.authorName},e.graphID))),Object(u.jsx)(m,{dispatcher:a,superState:i})]})]})},ye=(a(272),a(53)),ge=a.n(ye);a(282);ge.a.setAppElement("#root");var me=e=>{let{closeModal:t,ModelOpen:a,title:r,children:i}=e;const[n,o]=Object(s.useState)(""),[l,d]=Object(s.useState)(a),[c,h]=Object(s.useState)(null);return Object(s.useEffect)((()=>{!0===a?(d(!0),o("closing"),clearTimeout(c),h(setTimeout((()=>{d(!0),o("")}),20))):(o("closing"),clearTimeout(c),h(setTimeout((()=>{d(!1)}),400)))}),[a]),l?Object(u.jsx)(ge.a,{isOpen:l,contentLabel:"onRequestClose Example",className:"Modal",overlayClassName:`Overlay ${n}`,children:Object(u.jsxs)("div",{className:`modal-content ${n}`,children:[Object(u.jsxs)("div",{className:"modal-header",children:[Object(u.jsx)("div",{className:"modal-title h4",children:r}),Object(u.jsxs)("button",{type:"button",className:"close",onClick:t,children:[t?Object(u.jsx)("span",{"aria-hidden":"true",children:"\xd7"}):"",Object(u.jsx)("span",{className:"sr-only",children:"Close"})]})]}),Object(u.jsx)("div",{className:"modal-body",children:i})]})}):""};var Ee=e=>{let{closeModal:t,superState:a,dispatcher:r}=e;const[i,n]=Object(s.useState)({}),[l,d]=Object(s.useState)(""),[c,h]=Object(s.useState)(null),[b,y]=Object(s.useState)(!1),[g,m]=Object(s.useState)(!1),[E,O]=Object(s.useState)(!1),{modalPayload:f,ModelOpen:j}=a,{cb:_,title:S,submitText:v,Children:x,defaultStyle:D,defaultLabel:N,labelAllowed:I,type:A}=f;Object(s.useEffect)((()=>{d("")}),[j]),Object(s.useEffect)((()=>{n({label:N||"",style:D}),d("")}),[N,D]);const T=e=>{e.preventDefault();const a=_(i.label,i.style);a.ok?(d(""),n({label:N||"",style:D}),t()):d(a.err)};Object(s.useEffect)((()=>{g&&P(0,r),b&&null===c?o.b.error("Respective file is not present in same directory"):null!==c&&M(0,r,c.fileObj,c.fileHandle),y(!1),m(!1)}),[g,b]),Object(s.useEffect)((()=>{E&&P(0,r),O(!1)}),[E]);return Object(u.jsx)(me,{closeModal:t,ModelOpen:j,title:S,children:Object(u.jsxs)("form",{onSubmit:T,children:[Object(u.jsxs)("div",{className:"modal-content-body",children:[Object(u.jsx)(x,{data:i,setData:n,labelAllowed:I,state:a}),l?Object(u.jsx)("div",{className:"err",children:l}):Object(u.jsx)(u.Fragment,{})]}),Object(u.jsxs)("div",{className:"modal-footer",children:[Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",children:v}),"Node"===A?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("button",{className:"btn btn-primary",type:"button",onClick:()=>{if(h(null),void 0!==a.fileState&&""!==i.label){const e=i.label.split(":")[1];a.fileState.forEach((t=>{t.key.split("/")[1]!==e&&t.key.split("/")[2]!==e||h(t)}))}"Edit Node"===v?y(!0):"Create Node"===v&&m(!0)},children:"Edit Node"===v?"Edit Source":"Create Source"}),"Edit Node"===S?Object(u.jsx)("button",{className:"btn btn-primary",type:"button",onClick:async()=>{if(r({type:p.a.SET_MARKDOWN_MODAL,payload:!0}),h(null),void 0!==a.fileState&&""!==i.label){const e=i.label.split(":")[1].split(".")[0].concat(".md"),t=a.fileState.find((t=>t.key.split("/")[1]===e));if(t){const e=new FileReader;e.onload=e=>{r({type:p.a.SET_INPUT_FILE,payload:{content:e.target.result,fname:t.key.split("/")[1]}})},t.fileHandle?e.readAsText(await t.fileHandle.getFile()):t.fileObj&&e.readAsText(t.fileObj),h(t)}}},children:"Help"}):Object(u.jsx)("button",{className:"btn btn-primary",type:"button",onClick:()=>{if(h(null),void 0!==a.fileState&&""!==i.label){const e=i.label.split(":")[1].split(".")[0].concat(".md"),t=i.label.split(":")[1].split(".")[0].concat(".txt");a.fileState.forEach((a=>{a.key.split("/")[1]!==e&&a.key.split("/")[1]!==t||h(a)}))}O(!0)},children:"Create Help"}),"Edit Node"===S?"":Object(u.jsx)("button",{className:"btn btn-primary",type:"button",onClick:e=>{const t=i.label.split(":")[1];void 0!==t&&""!==t?(a.curGraphInstance.library(t),T(e)):o.b.error("Enter File Name")},children:"Create Library"})]}):""]})]})})},Oe=a(24),fe=a(54);var je=(e,t)=>[{type:"action",text:"Node",icon:Oe.j,action:w,active:e.curGraphInstance,visibility:!0,hotkey:"Ctrl+G"},{type:"vsep"},{type:"action",text:"Create",icon:Oe.i,action:P,active:!0,visibility:!0},{type:"file-upload",text:"Open",icon:Oe.f,action:k,active:!0,visibility:!0,hotkey:"Ctrl+O"},{type:"action",text:"Save",icon:Oe.m,action:G,active:e.curGraphInstance,visibility:!0},{type:"action",text:"Save As",icon:Oe.m,action:(e,t)=>(e=>{T(e).saveToDisk()})(e),active:e.curGraphInstance,visibility:!0},{type:"action",text:"Empty",icon:Oe.o,action:B,active:e.curGraphInstance&&!e.resetEnabled,visibility:!0,hotkey:"Ctrl+Backspace"},{type:"action",text:"Restore",icon:Oe.r,action:W,active:e.curGraphInstance&&e.resetEnabled,visibility:!0,hotkey:"Ctrl+I"},{type:"vsep"},{type:"action",text:"Undo",icon:Oe.s,action:H,active:e.undoEnabled&&e.curGraphInstance&&!e.resetEnabled,visibility:!0,hotkey:"Ctrl+Z"},{type:"action",text:"Redo",icon:Oe.k,action:$,active:e.redoEnabled&&e.curGraphInstance&&!e.resetEnabled,visibility:!0,hotkey:"Ctrl+Shift+Z,Ctrl+Y"},{type:"vsep"},{type:"action",text:"Edit",icon:Oe.e,action:C,active:e.curGraphInstance&&e.eleSelected,visibility:!0,hotkey:"Ctrl+E"},{type:"action",text:"Delete",icon:Oe.q,action:()=>((e,t)=>{const a=(new Date).getTime();e.eleSelectedPayload.ids.forEach((t=>T(e).deleteElem(t,a))),t({type:p.a.ELE_UNSELECTED,payload:null})})(e,t),active:e.curGraphInstance&&e.eleSelected,visibility:!0,hotkey:"Delete,Backspace,Del,Clear"},{type:"vsep"},{type:"action",text:"History",icon:Oe.h,action:z,active:e.curGraphInstance,visibility:!0},{type:"vsep"},{type:"action",text:"Logs",icon:Oe.n,action:U,active:!0,visibility:!0},{type:"action",text:"Server",icon:e.isWorkflowOnServer?Oe.p:fe.c,action:()=>((e,t)=>{e.isWorkflowOnServer?t({type:p.a.IS_WORKFLOW_ON_SERVER,payload:!1}):t({type:p.a.IS_WORKFLOW_ON_SERVER,payload:!0})})(e,t),active:e.curGraphInstance,visibility:!0},{type:"action",text:"Options",icon:Oe.c,action:()=>{t({type:p.a.SET_OPTIONS_MODAL,payload:!0})},active:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"action",text:"Build",icon:Oe.g,action:()=>e.curGraphInstance&&e.curGraphInstance.build(),active:-1!==e.curGraphIndex?e.isWorkflowOnServer&&e.graphs[e.curGraphIndex].built:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"action",text:"Debug",icon:Oe.b,action:()=>e.curGraphInstance&&e.curGraphInstance.debug(),active:-1!==e.curGraphIndex?e.isWorkflowOnServer&&e.graphs[e.curGraphIndex].debugged:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"action",text:"Run",icon:fe.a,action:()=>e.curGraphInstance&&e.curGraphInstance.run(),active:-1!==e.curGraphIndex?e.isWorkflowOnServer&&e.graphs[e.curGraphIndex].ran:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"action",text:"Clear",icon:Oe.l,action:()=>e.curGraphInstance&&e.curGraphInstance.clear(),active:-1!==e.curGraphIndex?e.isWorkflowOnServer&&e.graphs[e.curGraphIndex].cleared:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"action",text:"Stop",icon:fe.b,action:()=>e.curGraphInstance&&e.curGraphInstance.stop(),active:-1!==e.curGraphIndex?e.isWorkflowOnServer&&e.graphs[e.curGraphIndex].stopped:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"action",text:"Destroy",icon:Oe.a,action:()=>e.curGraphInstance&&e.curGraphInstance.destroy(),active:-1!==e.curGraphIndex?e.isWorkflowOnServer&&e.graphs[e.curGraphIndex].destroyed:e.isWorkflowOnServer,visibility:e.isWorkflowOnServer&&e.curGraphInstance},{type:"space"},{type:"action",text:"Contribute",icon:fe.d,action:F,active:!0,visibility:!0},{type:e.curGraphInstance?"menu":"action",text:"Export",icon:Oe.d,action:(e,t)=>[{fn:()=>L(e,0,"JPG"),name:"JPG"},{fn:()=>L(e,0,"PNG"),name:"PNG"}],visibility:!0,active:e.curGraphInstance},{type:"vsep"}],_e=(a(283),a(284),a(151)),Se=a(74);function ve(e){let{Icon:t,text:a,action:s,active:r,visibility:i,tabIndex:n,hotkey:o}=e;return Object(u.jsx)(Se.a,{menuButton:Object(u.jsx)(Se.b,{children:Object(u.jsx)(Ne,{Icon:t,text:a,action:s,active:r,visibility:i,tabIndex:n,hotkey:o})}),children:s().map((e=>{let{fn:t,name:a}=e;return Object(u.jsx)(Se.c,{onClick:t,children:a},a)}))})}const xe=e=>{let{Icon:t,text:a,active:s,visibility:r,tabIndex:i,hotkey:n,superState:o}=e;return Object(u.jsx)(Ne,{Icon:t,text:a,active:s,visibility:r,tabIndex:i,action:()=>o.fileRef.current.click(),hotkey:n})},De=e=>{let{text:t,action:a,active:s,tabIndex:r}=e;return Object(u.jsxs)("div",{role:"button",tabIndex:r,className:"tool "+(s?"active":""),onClick:a,onKeyDown:e=>" "===e.key&&a(),children:[Object(u.jsx)(_e.a,{onChange:a,checked:s,className:"react-switch"}),Object(u.jsx)("div",{children:t})]})},Ne=e=>{let{Icon:t,text:a,action:s,active:r,visibility:i,tabIndex:n,hotkey:o}=e;return Object(u.jsxs)("div",{role:"button",id:`action_${n}`,tabIndex:n,className:"tool "+(r?"active":""),onClick:()=>r&&s(),onKeyDown:e=>r&&" "===e.key&&s(),"data-tip":o?o.split(",")[0]:"",style:{display:""+(i?"":"none")},children:[Object(u.jsx)("div",{className:"icon",children:Object(u.jsx)(t,{size:"20"})}),Object(u.jsx)("div",{style:{fontSize:14},children:a})]})},Ie=()=>Object(u.jsx)("div",{className:"Vsep sep"}),Ae=()=>Object(u.jsx)("div",{className:"hsep sep"}),Te=()=>Object(u.jsx)("div",{className:"space"});a(285);const we=e=>{let{superState:t,dispatcher:a}=e;const s=je(t,a);return r.a.useEffect((()=>{(e=>{let t="";const a={};e.forEach(((e,s)=>{e.hotkey&&e.hotkey.split(",").forEach((e=>{[e,e.replace("Ctrl","Command")].forEach((e=>{t+=`${e},`,a[e]=document.getElementById(`action_${s+1}`)}))}))})),t=t.substring(0,t.length-1),Object(f.a)(t,((e,t)=>{e.preventDefault(),a[t.shortcut].click()}))})(s)}),[]),Object(u.jsxs)("header",{className:"header",children:[Object(u.jsx)("section",{className:"middle titlebar",children:t.curGraphInstance?`${t.curGraphInstance.projectName} - concore Editor`:"untitled"}),Object(u.jsx)("section",{className:"toolbar",children:s.map(((e,s)=>{let{text:r,active:i,visibility:n,action:o,icon:l,type:d,hotkey:c}=e;const h={text:r,active:i,visibility:n,tabIndex:s+1,key:r,action:e=>o(t,a,e),Icon:l,hotkey:c};switch(d){case"vsep":return Object(u.jsx)(Ie,{},`v${s}`);case"space":return Object(u.jsx)(Te,{},`s${s}`);case"switch":return Object(u.jsx)(De,{...h});case"menu":return Object(u.jsx)(ve,{...h});case"file-upload":return Object(u.jsx)(xe,{...h,superState:t});case"action":return Object(u.jsx)(Ne,{...h});default:return Object(u.jsx)(u.Fragment,{})}}))}),Object(u.jsx)(Ae,{})]})};a(286);var Ce=e=>{let{superState:t,dispatcher:a}=e;const r=t.graphs[t.curGraphIndex],[i,n]=Object(s.useState)("Untitled"),[o,l]=Object(s.useState)("Default"),d=Object(s.useCallback)((e=>e&&e.focus()),[]),{newGraphModal:c}=t,h=t.editDetailsModal||r&&!r.projectName;Object(s.useEffect)((()=>{t.editDetailsModal&&r?(n(r.projectName),l(r.authorName)):n("")}),[null===r||void 0===r?void 0:r.authorName,t.editDetailsModal,r]),Object(s.useEffect)((()=>{if(null!==r&&void 0!==r&&r.authorName)l(r.authorName);else{const e=E.a.getAuthorName();l(e)}}),[]);const b=()=>{t.fileRef.current.click()},y=()=>Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("div",{className:"divider"}),Object(u.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:b,children:"Open Existing From GraphML File"})]});return Object(u.jsx)(me,{ModelOpen:c||h,closeModal:t.editDetailsModal||t.newGraphModal?()=>{t.newGraphModal?a({type:p.a.SET_NEW_GRAPH_MODAL,payload:!1}):t.editDetailsModal&&a({type:p.a.SET_EDIT_DETAILS_MODAL,payload:!1})}:null,title:"Project Details",children:Object(u.jsxs)("form",{className:"proj-details",onSubmit:e=>{e.preventDefault(),c?a({type:p.a.ADD_GRAPH,payload:{projectName:i,authorName:o}}):h&&(t.curGraphInstance.setProjectName(i),t.curGraphInstance.setProjectAuthor(o),a({type:p.a.SET_EDIT_DETAILS_MODAL,payload:!1})),E.a.saveAllgs(),E.a.setAuthorName(o)},children:[Object(u.jsx)("span",{children:"Workflow Name"}),Object(u.jsx)("input",{ref:d,placeholder:"Title of workflow",required:!0,value:i,onChange:e=>n(e.target.value)}),Object(u.jsx)("span",{children:"Author"}),Object(u.jsx)("input",{placeholder:"Author of workflow",value:o,onChange:e=>l(e.target.value),required:!0}),Object(u.jsx)("div",{className:"expand",children:Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Save"})}),Object(u.jsx)("div",{className:"expand",children:c&&Object(u.jsx)(y,{})})]})})};a(287);var Le=e=>{let{superState:t,dispatcher:a}=e;const[r,i]=Object(s.useState)(""),[n,o]=Object(s.useState)("Copy"),l=t.shareModal&&t.curGraphInstance;Object(s.useEffect)((()=>{l&&(i(t.curGraphInstance.serializeGraph()),o("Copy"))}),[l]);const d=`${window.location.protocol}//${window.location.host}${window.location.pathname}?g=${r}`;return Object(u.jsx)(me,{ModelOpen:t.shareModal,title:"Shareable Link",closeModal:()=>{a({type:p.a.SET_SHARE_MODAL,payload:!1})},children:Object(u.jsxs)("div",{className:"share-modal",children:[Object(u.jsx)("input",{readOnly:!0,className:"preDiv",value:d}),Object(u.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(d).then((()=>{o("Copied!"),document.getElementsByClassName("preDiv")[0].focus(),document.getElementsByClassName("preDiv")[0].select()}))},type:"button",className:"copyBtn",children:n})]})})};a(134),a(288);var Ge=e=>{let{pre:t,post:a,value:s,onChange:i,height:n,docString:o}=e;const l=r.a.createRef();return Object(u.jsxs)("div",{className:"textField",onClick:()=>l.current.focus(),onKeyDown:()=>l.current.focus(),role:"textbox",tabIndex:0,children:[o?Object(u.jsx)("div",{className:"docStr",children:(d=o,d.split("**").map(((e,t)=>t%2?Object(u.jsx)("span",{children:Object(u.jsx)("b",{children:e})},e):Object(u.jsx)("span",{children:e},e))))}):Object(u.jsx)("div",{}),Object(u.jsx)("br",{}),t?Object(u.jsx)("textarea",{className:"preTextField",value:t,readOnly:!0,spellCheck:"false"}):Object(u.jsx)("div",{}),Object(u.jsx)("textarea",{className:"mainTextField",spellCheck:"false",value:s,onChange:i,"data-gramm_editor":"false",style:{height:n,width:"90vw"},ref:l}),a?Object(u.jsx)("textarea",{className:"postTextField",readOnly:!0,value:a,spellCheck:"false"}):Object(u.jsx)("div",{})]});var d};var ke=e=>{let{superState:t,dispatcher:a}=e;const[r,i]=Object(s.useState)(""),[n,o]=Object(s.useState)(""),[l,d]=Object(s.useState)("");Object(s.useEffect)((()=>{t.curGraphInstance&&(i(t.curGraphInstance.getNodeValidator()),o(t.curGraphInstance.getEdgeValidator()))}),[t.curGraphInstance]);return Object(u.jsx)(me,{ModelOpen:t.settingsModal,closeModal:()=>a({type:p.a.SET_SETTING_MODAL,payload:!1}),title:"Settings",children:Object(u.jsxs)("div",{className:"setting-container",children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("h3",{children:"Node Validator"}),Object(u.jsx)(Ge,{pre:"function validateNode(node, nodes, edges, type) {",post:"}",value:r,onChange:e=>i(e.target.value),height:200,docString:"Takes **`node`** details under validation, existing **`nodes`**, existing **`edges`** and **`type`**\n\n**Node:** { label: String, style: Object, id: String | undefined },\n**Nodes:** [{ label: String, style: Object, id: String }],\n**Edges:** [{ label: String, sourceLabel: String, targetLabel: String, style: Object, id: String }],\n**Type:** `New` | `Update`"})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h3",{children:"Edge  Validator"}),Object(u.jsx)(Ge,{pre:"function validateEdge(edge, nodes, edges, type) {",post:"}",value:n,onChange:e=>o(e.target.value),height:200,docString:"Takes **`edge`** details under validation, existing **`nodes`** and existing **`edges`** and **`type`**\n\n**Edge:** { label: String, sourceLabel: String, targetLabel: String, style: Object, id: String | undefined },\n**Nodes:** [{ label: String, style: Object, id: String }],\n**Edges:** [{ label: String, sourceLabel: String, targetLabel: String, style: Object, id: String }],\n**Type:** `New` | `Update`"})]}),Object(u.jsx)("div",{className:"error",children:l}),Object(u.jsx)("div",{className:"footer",children:Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:()=>{try{t.curGraphInstance.setEdgeNodeValidator({nodeValidator:`(node, nodes, edges, type)=>{${r}}`,edgeValidator:`(edge, nodes, edges, type)=>{${n}}`}),a({type:p.a.SET_SETTING_MODAL,payload:!1}),d("")}catch(e){d(e.message)}},children:"Save"})})]})})};a(289);var Me=e=>{let{superState:t,dispatcher:a}=e;const i=r.a.useRef();return Object(s.useEffect)((()=>{a({type:p.a.SET_FILE_REF,payload:i});const e=document.getElementsByTagName("body")[0],t=document.getElementsByClassName("drag-drop-area")[0];let s=0;e.addEventListener("dragenter",(e=>{e.preventDefault(),s+=1,1===s&&t.classList.remove("hidden")})),e.addEventListener("dragleave",(e=>{e.preventDefault(),s-=1,0===s&&t.classList.add("hidden")})),e.addEventListener("dragover",(e=>{e.preventDefault()})),["dragend","dragexit","drop"].forEach((a=>{e.addEventListener(a,(e=>{e.preventDefault(),s=0,t.classList.add("hidden")}))})),e.addEventListener("drop",(e=>{e.preventDefault(),i.current.value=null,1===e.dataTransfer.files.length&&"graphml"===e.dataTransfer.files[0].name.split(".").slice(-1)[0]&&k(0,a,e.dataTransfer.files[0])}))}),[]),Object(u.jsx)("div",{className:"drag-drop-area hidden",children:Object(u.jsxs)("div",{className:"inner",children:[Object(u.jsx)(Oe.f,{size:100,style:{color:"#1e88e5"}}),Object(u.jsxs)("div",{children:[Object(u.jsx)("input",{type:"file",ref:i,onClick:e=>{e.target.value=null},style:{display:"none"},accept:".graphml",onChange:e=>k(0,a,e)}),Object(u.jsx)("span",{className:"arrow",children:"\u27f6"}),Object(u.jsx)("h1",{className:"text",children:"Drop the File anywhere to open"})]})]})})};a(290);var Pe=e=>{let{superState:t,dispatcher:a}=e;const[r,i]=Object(s.useState)(0),[n,o]=Object(s.useState)([]),[l,d]=Object(s.useState)([]),c=[se.a.ADD_NODE,se.a.ADD_EDGE,se.a.UPDATE_NODE,se.a.UPDATE_EDGE,se.a.DEL_NODE,se.a.DEL_EDGE,se.a.SET_DIM,se.a.SET_BENDW,se.a.SET_POS],[h,b]=Object(s.useState)((()=>{const e={};return c.forEach((t=>{e[t]=!0})),e})()),y=e=>t.curGraphInstance?t.curGraphInstance.getLabelFromID(e):"";Object(s.useEffect)((()=>{t.curGraphInstance&&(o([...t.curGraphInstance.actionArr.slice().reverse().map(((e,t)=>({...e,i:t})))]),i(t.curGraphInstance.actionArr.length-t.curGraphInstance.curActionIndex))}),[t.viewHistory,t.graphs,t.curGraphInstance,r]);const g={[se.a.ADD_NODE]:"NodeAddition:",[se.a.ADD_EDGE]:"EdgeAddition",[se.a.UPDATE_NODE]:"NodeUpdates",[se.a.UPDATE_EDGE]:"EdgeUpdates",[se.a.DEL_NODE]:"NodeDeletion",[se.a.DEL_EDGE]:"EdgeDeletion",[se.a.SET_POS]:"NodePosChange",[se.a.SET_DIM]:"NodeDimensionChange",[se.a.SET_BENDW]:"EdgeBend"},m=(e,a,s,n,o)=>{const l=new Date(parseInt(e,10)),d=l.toLocaleDateString(),c=l.toLocaleTimeString(),h=Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("td",{children:n===r?"[Current]":Object(u.jsx)("button",{className:"a-link",type:"button",onClick:()=>(e=>{if(window.confirm("Are you sure to restore the selected state?")){let a=r;for(;e>a;)t.curGraphInstance.undoSingleAction(),a+=1;for(;e<a;)t.curGraphInstance.redoSingleAction(),a-=1;i(a)}})(n),children:"[Restore]"})}),Object(u.jsx)("td",{children:`${d}-${c}`}),Object(u.jsxs)("td",{children:["[",Object(u.jsx)("b",{children:`${s}`}),"]"]}),Object(u.jsx)("td",{style:{fontWeight:100},children:a}),Object(u.jsx)("td",{style:{fontWeight:100},children:o})]});return h},E=e=>{let{equivalent:t,tid:a,i:s,authorName:r,hash:i}=e;return m(a,(e=>{const t=e.parameters;switch(e.actionName){case se.a.ADD_NODE:return`Created new Node: ${t[0]}`;case se.a.ADD_EDGE:return`Created new Edge ${y(t[0].id)} between ${y(t[0].sourceID)} and ${y(t[0].targetID)}`;case se.a.UPDATE_NODE:return`Updated Label/Style for ${y(t[0])} node`;case se.a.UPDATE_EDGE:return`Updated Edge ${y(t[0])}`;case se.a.DEL_NODE:return`Deleted Node: ${y(t[0])}`;case se.a.DEL_EDGE:return`Deleted Edge: ${y(t[0])}`;case se.a.SET_POS:return`Moved node ${y(t[0])} on canvas`;case se.a.SET_DIM:return`Changed dimension of node ${y(t[0])}`;case se.a.SET_BENDW:return`Modified Bend Point of node ${y(t[0])}`;default:return""}})(t),r,s,i)};Object(s.useEffect)((()=>{d(n.filter((e=>h[e.equivalent.actionName])).map(E))}),[h,n]);return Object(u.jsx)(me,{ModelOpen:t.viewHistory,closeModal:()=>a({type:p.a.SET_HISTORY_MODAL,payload:!1}),title:"History",children:Object(u.jsxs)("div",{className:"hist-container",children:[Object(u.jsxs)("fieldset",{children:[Object(u.jsx)("legend",{children:"Filters"}),c.map((e=>Object(u.jsxs)("label",{htmlFor:e,className:"filter_checkbox",children:[Object(u.jsx)("input",{type:"checkbox",name:"filter",checked:h[e],onChange:()=>b({...h,[e]:!h[e]})}),g[e]]},e)))]}),Object(u.jsx)("div",{className:"hist-list",children:Object(u.jsx)("table",{style:{listStyleType:"circle"},children:Object(u.jsx)("tbody",{children:l.map(((e,t)=>Object(u.jsx)("tr",{className:"hist-element "+(t===r?"active":""),children:e},t)))})})})]})})},Re=a(75),Be=a.n(Re);a(332);var Fe=e=>{let{superState:t,dispatcher:a}=e;const i=r.a.useRef(),[n,o]=Object(s.useState)(!1),[l,d]=Object(s.useState)([]);Object(s.useEffect)((()=>{-1===navigator.userAgent.indexOf("Edg")&&-1===navigator.userAgent.indexOf("Chrome")||o(!0),a({type:p.a.SET_FILE_REF,payload:i})}),[]),Object(s.useEffect)((()=>{window.localStorage.setItem("fileList",JSON.stringify(l))}),[l]),Object(s.useEffect)((()=>{d(t.fileState)}),[t.fileState]);const c=async(e,t)=>{let a=e,s=[];for await(const[r,i]of t.entries())if("file"===i.kind){const a=await i.getFile();s=s.concat([{key:`${e}/${t.name}/${r}`,modified:a.lastModified,size:a.size,fileObj:a,fileHandle:i}])}else if("directory"===i.kind){a=`${e}/${t.name}`;const r=await c(a,i);s=s.concat(r)}return s};return Object(u.jsxs)("div",{children:[!n&&Object(u.jsxs)("label",{className:"inputButton",htmlFor:"fileButton",children:["Upload Directory",Object(u.jsx)("input",{type:"file",accept:".py, .m, .c, .cpp, .v, .sh",id:"fileButton",style:{display:"none"},onClick:e=>{e.target.value=null},onChange:e=>{const t=Array.from(e.target.files).map((e=>({key:e.webkitRelativePath,modified:e.lastModified,size:e.size,fileObj:e})));d(t),window.localStorage.setItem("fileList",JSON.stringify(t))},webkitdirectory:!0})]}),n&&Object(u.jsx)("button",{type:"button",className:"inputButton",disabled:!n,onClick:async()=>{const e=await window.showDirectoryPicker();let t=[];for await(const[a,s]of e.entries())if("file"===s.kind){const r=await s.getFile();t=t.concat([{key:`${e.name}/${a}`,modified:r.lastModified,size:r.size,fileObj:r,fileHandle:s}])}else if("directory"===s.kind){const a=await c(e.name,s);t=t.concat(a)}d([]),d(t),a({type:p.a.SET_DIR_NAME,payload:t[0].key.split("/")[0]}),a({type:p.a.SET_FILE_STATE,payload:t})},children:"Upload Directory"}),!n&&Object(u.jsx)("input",{type:"file",ref:i,onClick:e=>{e.target.value=null},style:{display:"none"},accept:".graphml",onChange:e=>k(0,a,e.target.files[0])}),n&&Object(u.jsx)("button",{type:"button",ref:i,className:"inputButton",disabled:!n,style:{display:"none"},onClick:async()=>{const[e]=await window.showOpenFilePicker({types:[{description:"Graphml",accept:{"text/graphml":[".graphml"]}}],excludeAcceptAllOption:!0,multiple:!1}),t=await e.getFile();k(0,a,t,e)},label:"File Upload"}),Object(u.jsxs)("h4",{children:["Folder Name :"," ",l[0]?l[0].key.split("/")[0]:""]}),Object(u.jsx)(Be.a,{files:l,onSelectFile:e=>{if(["jpeg","jpg","png","exe"].includes(e.fileObj.name.split(".").pop()))alert("Wrong file extension");else if("graphml"===e.fileObj.name.split(".").pop()){let s=-1;t.graphs.forEach(((t,a)=>{t.fileName===e.fileObj.name&&(s=a)})),-1!==s?a({type:p.a.CHANGE_TAB,payload:s}):k(0,a,e.fileObj,e.fileHandle)}else M(0,a,e.fileObj,e.fileHandle)},detailRenderer:()=>null,fileRenderer:Re.FileRenderers.TableFile,folderRenderer:Re.FolderRenderers.TableFolder})]})},We=a(159);a(333);var Ue=e=>{let{superState:t,dispatcher:a}=e;const[r,i]=Object(s.useState)(""),[n,l]=Object(s.useState)(""),[d,c]=Object(s.useState)(!1),[h,b]=Object(s.useState)("plaintext"),[y,g]=Object(s.useState)(""),[m,E]=Object(s.useState)(!1);Object(s.useEffect)((()=>{-1===navigator.userAgent.indexOf("Edg")&&-1===navigator.userAgent.indexOf("Chrome")||c(!0)}),[]);return Object(s.useEffect)((()=>{!async function(){if(t.fileObj){l(t.fileObj.name);const e=new FileReader;e.onload=e=>{i(e.target.result)},t.fileHandle?e.readAsText(await t.fileHandle.getFile()):e.readAsText(t.fileObj)}}()}),[t.fileObj]),Object(s.useEffect)((()=>{if(!n)return;const e=n.split(".").pop();b({v:"verilog",c:"c",h:"c",hpp:"cpp",cpp:"cpp",py:"python",m:"matlab",sh:"bash"}[e]||"plaintext")}),[n]),Object(u.jsxs)(me,{ModelOpen:t.textFileModal,closeModal:()=>{a({type:p.a.EDIT_TEXTFILE,payload:{show:!1}}),i(""),l("")},title:n,children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"setting-container",children:Object(u.jsx)(We.a,{height:"60vh",language:h,theme:"vs-light",value:r,onChange:e=>i(e),options:{inlineSuggest:!0,fontSize:16,formatOnType:!0,autoClosingBrackets:!0,minimap:{enabled:!0}}})}),Object(u.jsxs)("div",{className:"save-bar",children:[n&&Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:async function(){if(t.fileHandle){const e=await t.fileHandle.createWritable();await e.write(r),await e.close()}else o.b.warn("Switch to Edge/Chrome!");a({type:p.a.EDIT_TEXTFILE,payload:{show:!1}})},children:"Save"}),d&&Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:async function(){const e=await window.showSaveFilePicker(),s=await e.createWritable();await s.write(r),await s.close();const i=await e.getFile();let n=t.fileState;n=n.concat([{key:`${t.uploadedDirName}/${e.name}`,modified:i.lastModified,size:i.size,fileObj:i,fileHandle:e}]),a({type:p.a.SET_FILE_STATE,payload:n})},children:"Save As"}),!d&&Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:function(){E(!0)},children:"Save As"})]})]}),Object(u.jsxs)(ge.a,{isOpen:m,onRequestClose:()=>E(!1),className:"modal-content",overlayClassName:"modal-overlay",ariaHideApp:!1,children:[Object(u.jsx)("h2",{children:"Enter Filename"}),Object(u.jsx)("input",{type:"text",value:y,onChange:e=>g(e.target.value),className:"modal-input",placeholder:"Filename"}),Object(u.jsxs)("div",{className:"modal-actions",children:[Object(u.jsx)("button",{type:"button",onClick:function(){if(""===y.trim())return void o.b.error("Filename cannot be empty!");const e=(new TextEncoder).encode(r),t=new Blob([e],{type:"application/json;charset=utf-8"});Object(q.saveAs)(t,y),E(!1)},className:"btn btn-primary",children:"Save"}),Object(u.jsx)("button",{type:"button",onClick:()=>E(!1),className:"btn btn-secondary",children:"Cancel"})]})]})]})},He=a(359);var $e=e=>{let{superState:t,dispatcher:a}=e;return Object(u.jsx)(me,{closeModal:()=>{a({type:p.a.SET_MARKDOWN_MODAL,payload:!1}),a({type:p.a.SET_INPUT_FILE,payload:{inputFile:"",fname:""}})},ModelOpen:t.markDownModal,title:t.inputFileName,children:Object(u.jsx)(He.a,{children:t.inputFile})})};a(336);var ze=e=>{let{superState:t,dispatcher:a}=e;const[r,i]=Object(s.useState)(!1),[n,o]=Object(s.useState)(!1),[l,d]=Object(s.useState)(!1),[c,h]=Object(s.useState)(""),[b,y]=Object(s.useState)(""),[g,m]=Object(s.useState)("");return Object(u.jsx)(me,{closeModal:()=>{a({type:p.a.SET_OPTIONS_MODAL,payload:!1}),a({type:p.a.SET_OPTIONS,payload:{unlock:r,docker:n,maxT:b,param:c,octave:l,library:g}})},ModelOpen:t.optionsModal,title:"Options",children:Object(u.jsxs)("div",{className:"main-div",children:[Object(u.jsxs)("label",{htmlFor:"Docker",children:["Docker",Object(u.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{o(!n)}})]}),Object(u.jsxs)("label",{htmlFor:"Octave",className:"main-div-comp",children:["Octave",Object(u.jsx)("input",{type:"checkbox",checked:l,onChange:()=>{d(!l)}})]}),Object(u.jsxs)("label",{htmlFor:"Unlock",className:"main-div-comp",children:["Unlock",Object(u.jsx)("input",{type:"checkbox",checked:r,onChange:()=>{i(!r)}})]}),Object(u.jsxs)("label",{htmlFor:"Maxtime",className:"main-div-comp",children:["Max Time:\xa0",Object(u.jsx)("input",{type:"text",value:b,placeholder:"Enter Maximum Time",onChange:e=>{(e=>{y(e.target.value)})(e)}})]}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsxs)("label",{htmlFor:"librarypath",children:["Library Path:\xa0\xa0",Object(u.jsx)("input",{size:"59",type:"text",value:g,placeholder:"Enter library path",onChange:e=>{(e=>{m(e.target.value)})(e)}})]}),Object(u.jsx)("br",{}),Object(u.jsx)("br",{}),Object(u.jsx)("span",{children:"Params:"}),Object(u.jsx)("br",{}),Object(u.jsx)("textarea",{cols:"80",rows:"10",value:c,onChange:e=>{(e=>{h(e.target.value)})(e)}})]})})};a(337);var Ve=e=>{let{superState:t,dispatcher:a}=e;const[r,i]=Object(s.useState)("");return Object(s.useEffect)((()=>{t.logs?(document.getElementById("outlay").style.display="block",document.getElementById("terminal").style.display="block",i(t.logsmessage)):(document.getElementById("terminal").style.display="none",document.getElementById("outlay").style.display="none",i(t.logsmessage))}),[t.logs]),Object(u.jsx)(u.Fragment,{children:Object(u.jsx)("div",{className:"outlay",id:"outlay",children:Object(u.jsxs)("div",{className:"terminal",id:"terminal",children:[Object(u.jsxs)("div",{className:"terminal-header",children:["Logs",Object(u.jsx)("button",{type:"button",className:"clear",onClick:()=>{i(""),a({type:p.a.SET_LOGS_MESSAGE,payload:""})},children:"Clear"}),Object(u.jsx)("button",{type:"button",className:"closelogs",onClick:()=>{a({type:p.a.SET_LOGS,payload:!1})},children:"X"})]}),Object(u.jsx)("div",{className:"terminal-body",children:r.split("\n").map((e=>Object(u.jsx)("div",{className:"terminal-line",children:e})))})]})})})};a(338);var Ke=e=>{let{superState:t,dispatcher:a}=e;const r=()=>{a({type:p.a.SET_CONTRIBUTE_MODAL,payload:!1})},[i,n]=Object(s.useState)(""),[l,d]=Object(s.useState)(""),[c,h]=Object(s.useState)(""),[b,y]=Object(s.useState)(""),[g,m]=Object(s.useState)(""),[E,O]=Object(s.useState)(""),[f,j]=Object(s.useState)(!1);return Object(u.jsx)(me,{ModelOpen:t.contributeModal,title:"Contribute",closeModal:r,children:Object(u.jsxs)("form",{className:"contribute-details",children:[Object(u.jsx)("span",{children:"Study Name"}),Object(u.jsx)("input",{required:!0,value:i,onChange:e=>n(e.target.value)}),Object(u.jsx)("span",{children:"Study Path"}),Object(u.jsx)("input",{placeholder:"Enter Full Directory Path of Study",value:l,onChange:e=>d(e.target.value),required:!0}),Object(u.jsx)("span",{children:"Author Name"}),Object(u.jsx)("input",{value:c,onChange:e=>h(e.target.value),required:!0}),f&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("span",{children:"Branch Name"}),Object(u.jsx)("input",{value:E,onChange:e=>O(e.target.value)}),Object(u.jsx)("span",{children:"Title of Study"}),Object(u.jsx)("input",{value:b,onChange:e=>y(e.target.value)}),Object(u.jsx)("span",{children:"Description of Study"}),Object(u.jsx)("textarea",{value:g,onChange:e=>m(e.target.value)})]}),Object(u.jsxs)("button",{type:"button",className:"btn btn-secondary",onClick:()=>{j(!f)},children:[f?"Hide ":"Show ","Advance Options"]}),Object(u.jsx)("div",{className:"expand",children:Object(u.jsx)("button",{type:"submit",className:"btn btn-primary",onClick:async e=>{if(""===i||""===l||""===c)return void o.b.info("Please Provide necessary inputs");const t=o.b.loading("Processing your Request.Please wait...");try{var a;e.preventDefault();const t=await K.a.post("http://127.0.0.1:5000/contribute",{study:i,auth:c,desc:g,title:b,path:l,branch:E});o.b.success(null===(a=t.data)||void 0===a?void 0:a.message)}catch(h){var s,n,d;if(400===(null===h||void 0===h||null===(s=h.response)||void 0===s?void 0:s.status))o.b.info(null===h||void 0===h||null===(n=h.response)||void 0===n||null===(d=n.data)||void 0===d?void 0:d.message);else o.b.error(null===h||void 0===h?void 0:h.response.data.message)}o.b.dismiss(t),r()},children:"Generate PR"})})]})})};var qe=()=>{const[e,t]=Object(s.useReducer)(p.c,p.b);return Object(s.useEffect)((()=>(window.onbeforeunload=e=>(e.returnValue="Are you sure you want to leave this page?","Are you sure you want to leave this page?"),()=>{window.onbeforeunload=null})),[]),Object(u.jsxs)("div",{className:"container",children:[Object(u.jsx)(Ce,{superState:e,dispatcher:t}),Object(u.jsx)(Le,{superState:e,dispatcher:t}),Object(u.jsx)(ke,{superState:e,dispatcher:t}),Object(u.jsx)(Pe,{superState:e,dispatcher:t}),Object(u.jsx)(Ke,{superState:e,dispatcher:t}),Object(u.jsx)(Ue,{superState:e,dispatcher:t}),Object(u.jsx)(ze,{superState:e,dispatcher:t}),Object(u.jsx)(Ee,{closeModal:()=>t({type:p.a.Model_Close}),superState:e,dispatcher:t}),Object(u.jsx)(Ve,{superState:e,dispatcher:t}),Object(u.jsx)($e,{superState:e,dispatcher:t}),Object(u.jsx)(Me,{dispatcher:t}),Object(u.jsx)(we,{superState:e,dispatcher:t}),Object(u.jsxs)("section",{className:"body",style:{display:"flex",overflow:"hidden"},children:[Object(u.jsx)("div",{style:{display:"flex",overflow:"auto"},children:Object(u.jsx)(Fe,{superState:e,dispatcher:t})}),Object(u.jsx)("div",{className:"graph",style:{display:"flex",overflow:"hidden"},children:Object(u.jsx)(be,{dispatcher:t,superState:e})})]}),Object(u.jsx)(l.a,{place:"bottom",type:"dark",effect:"solid"}),Object(u.jsx)(o.a,{position:"bottom-left",autoClose:8e3,pauseOnHover:!1})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Je=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,361)).then((t=>{let{getCLS:a,getFID:s,getFCP:r,getLCP:i,getTTFB:n}=t;a(e),s(e),r(e),i(e),n(e)}))};n.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(qe,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{e.unregister()})).catch((e=>{console.error(e.message)})),Je()},45:function(e,t,a){"use strict";const s={dist:(e,t)=>((e.x-t.x)**2+(e.y-t.y)**2)**.5,rotate:(e,t)=>({x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}),extraRad:(e,t)=>e.x>=t.x&&e.y>t.y||e.x>=t.x&&e.y<t.y?Math.PI:0,getRadian(e,t,a){return(Math.atan(e)-this.extraRad(t,a)+2*Math.PI)%(2*Math.PI)},getCoordinate(e,t,a,s){const r=(a.y-s.y)/(a.x-s.x),i=this.getRadian(r,a,s),n={x:this.dist(a,s)*e,y:t},{x:o,y:l}=this.rotate(n,i);return{x:o+a.x,y:l+a.y}},getWeightDistance(e,t,a){const s={x:e.x-t.x,y:e.y-t.y},r=(t.y-a.y)/(t.x-a.x),i=this.getRadian(r,t,a),{x:n,y:o}=this.rotate(s,-i);return{d:o,w:n/this.dist(t,a)}}};t.a=s},7:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return b})),a.d(t,"b",(function(){return p}));var s=a(182)({$$typeof:"",Model_Open_Create_Node:"OpenModal_CreateNode",Model_Open_Create_Edge:"OpenModal_CreateEdge",Model_Open_Update_Edge:"OpenModal_UpdateEdge",Model_Open_Update_Node:"OpenModal_UpdateNode",Model_Close:"CloseModal",ELE_UNSELECTED:"ELE_UNSELECTED",ELE_SELECTED:"ELE_SELECTED",TURN_DRAW:"TURN_DRAW",SET_ZOOM:"SET_ZOOM",SET_PROJECT_DETAILS:"SET_PROJECT_DETAILS",SET_UNDO:"SET_UNDO",SET_REDO:"SET_REDO",ADD_GRAPH_INSTANCE:"ADD_GRAPH_INSTANCE",ADD_GRAPH:"ADD_GRAPH",ADD_GRAPH_BULK:"ADD_GRAPH_BULK",CHANGE_TAB:"CHANGE_TAB",CHANGE_RESET:"CHANGE_RESET",REMOVE_GRAPH:"REMOVE_GRAPH",NEW_GRAPH:"NEW_GRAPH",SET_SHARE_MODAL:"SET_SHARE_MODAL",SET_SETTING_MODAL:"SET_SETTING_MODAL",SET_MARKDOWN_MODAL:"SET_MARKDOWN_MODAL",SET_CONTRIBUTE_MODAL:"SET_CONTRIBUTE_MODAL",SET_FILE_REF:"SET_FILE_REF",SET_HISTORY_MODAL:"SET_HISTORY_MODAL",SET_AUTHOR:"SET_AUTHOR",IS_WORKFLOW_ON_SERVER:"IS_WORKFLOW_ON_SERVER",SET_CUR_INSTANCE:"SET_CUR_INSTANCE",SET_CUR_INDEX:"SET_CUR_INDEX",SET_ZOOM_LEVEL:"SET_ZOOM_LEVEL",SET_EDIT_DETAILS_MODAL:"SET_EDIT_DETAILS_MODAL",SET_NEW_GRAPH_MODAL:"SET_NEW_GRAPH_MODAL",SET_OPTIONS_MODAL:"SET_OPTIONS_MODAL",EDIT_TEXTFILE:"EDIT_TEXTFILE",SET_FILE_HANDLE:"SET_FILE_HANDLE",SET_DIR_NAME:"SET_DIR_NAME",SET_FILE_STATE:"SET_FILE_STATE",SET_INPUT_FILE:"SET_INPUT_FILE",SET_OPTIONS:"SET_OPTIONS",SET_FUNCTIONS:"SET_FUNCTIONS",SET_LOGS:"SET_LOGS",SET_LOGS_MESSAGE:"SET_LOGS_MESSAGE"}),r=a(1),i=(a(187),a(31)),n=a(2);var o=e=>{let{data:t,setData:a,submit:s,labelAllowed:o,state:l}=e;const d=Object(r.useCallback)((e=>e&&e.focus()),[]),c=Object(r.createRef)(),[h]=Object(r.useState)(!1),[p,u]=Object(r.useState)([]),[b,y]=Object(r.useState)(new Map("")),[g,m]=Object(r.useState)(""),[E,O]=Object(r.useState)(""),f=[];f.push(0);return Object(r.useEffect)((()=>{const e=p;l.fileState.forEach((t=>{if(t.key.toString().includes(".md")){e.push(t),u(e);let a=new Map;a=b;const s=new FileReader;s.onload=e=>{a.set(t,"   DESC: ".concat(e.target.result.slice(0,50).replace("#",""))),y(a)},s.readAsText(t.fileObj)}}))}),[l.fileState]),Object(r.useEffect)((()=>{var e;h||(e={width:Math.max(t.style.width,Math.min(500,c.current.offsetWidth+20))},a({...t,style:{...t.style,...e}}))}),[!h&&t.label]),Object(r.useEffect)((()=>{m(t.label.split(":")[0])}),[t.label]),Object(n.jsxs)("div",{className:"nodeform",onSubmit:s,children:[Object(n.jsx)("div",{className:"parent-div",style:{height:t.style.height},children:Object(n.jsx)("div",{className:"node-div",style:{...t.style,borderRadius:"ellipse"===t.style.shape?"100%":0},children:Object(n.jsx)("span",{ref:c,children:o?t.label:""})})}),Object(n.jsxs)("div",{className:"form",style:{padding:20},children:[o?Object(n.jsx)("div",{children:" Label"}):"",o?Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("input",{className:"nodeLabel",ref:d,type:"text",required:!0,label:"Node Label",placeholder:"Enter Node Label",value:t.label.split(":")[0],onChange:e=>{":"!==e.target.value.slice(-1)?(m(`${e.target.value}:`),a({...t,label:`${e.target.value}:${E}`})):(m(e.target.value),a({...t,label:e.target.value+E}))}}),Object(n.jsx)("input",{className:"nodeLabelFile",type:"text",label:"Node Label file",placeholder:"Select file",value:t.label.split(":")[1],onChange:e=>{if(O(e.target.value.split("/").pop().split("   DESC: ")[0]),g){let s=g;":"!==g.slice(-1)&&(m(`${g}:`),s+=":"),a({...t,label:s+e.target.value.split("/").pop().split("   DESC: ")[0]})}else a({...t,label:`:${e.target.value.split("/").pop().split("   DESC: ")[0]}`})},list:"files"}),Object(n.jsx)("datalist",{id:"files",children:i.a.getFileList()?l.fileState.map((e=>{const t=[];let a;if(e.key.toString().includes(".md"))return null;if(e.key.toString().split("/").length>2)return null;if([".v",".c",".cpp",".py",".m",".sh"].some((t=>e.key.toString().includes(t)))){const s=e.key.toString().split(".")[0].concat(".md"),r=p.find((e=>e.key.toString()===s));return b.get(r)?t.push(e.key.toString().concat(b.get(r))):t.push(e.key.toString()),f.push(f[f.length-1]+1),a=f[f.length-1]+1,Object(n.jsx)(n.Fragment,{children:Object(n.jsx)("label",{htmlFor:"dropdown",children:Object(n.jsx)("option",{value:t},a)})})}return null})):""})]}):""]})]})};a(189);const l=e=>{let{size:t,color:a}=e;const s=5*parseInt(t,10),r={borderLeft:`${.8666*s}px solid ${a}`,borderBottom:s/2+"px solid transparent",borderTop:s/2+"px solid transparent",marginLeft:-1};return Object(n.jsx)("div",{style:r})};var d=e=>{let{data:t,setData:a,submit:s,labelAllowed:i}=e;const o=Object(r.useCallback)((e=>e&&e.focus()),[]);return Object(n.jsxs)("div",{className:"edgeform",onSubmit:s,children:[Object(n.jsxs)("div",{className:"par-div",children:[Object(n.jsx)("div",{className:"edge-div",style:{borderBottomWidth:t.style.thickness,borderBottomColor:t.style.backgroundColor,borderBottomStyle:t.style.shape}}),Object(n.jsx)(l,{size:t.style.thickness,color:t.style.backgroundColor}),Object(n.jsx)("div",{className:"label",children:t.label})]}),Object(n.jsxs)("div",{className:"form",children:[i?Object(n.jsx)("div",{children:" Label"}):"",i?Object(n.jsx)("input",{ref:o,className:"span-rest edgeLabel",type:"text",required:!0,label:"Edge Label",value:t.label,placeholder:"Enter Edge Label",onChange:e=>a({...t,label:`${e.target.value}`})}):""]})]})};const c={width:100,height:50,shape:"rectangle",opacity:1,backgroundColor:"#ffcc00",borderColor:"#000",borderWidth:1},h={thickness:1,backgroundColor:null,shape:"solid"},p={ModelOpen:!1,modalPayload:{cb:()=>{},title:"",submitText:"",Children:"",defaultStyle:{},defaultLabel:"",labelAllowed:null},shareModal:!1,settingsModal:!1,editDetailsModal:!1,newGraphModal:!1,optionsModal:!1,markDownModal:!1,contributeModal:!1,eleSelected:!1,drawModeOn:!0,undoEnabled:!1,redoEnabled:!1,graphs:[],curGraphIndex:-1,viewHistory:!1,isWorkflowOnServer:!1,curGraphInstance:null,zoomLevel:100,uploadedDirName:null,resetEnabled:!1,fileState:[],inputFile:"",params:"",maxTime:"",library:"",dockerCheck:!1,unlockCheck:!1,octave:!1,logs:!1,logsmessage:""},u={projectName:"",graphID:null,serverID:null,graphML:null,authorName:"",component:null,instance:null,id:null,fileHandle:null,fileName:null,built:!0,debugged:!1,ran:!1,destroyed:!1,cleared:!1,stopped:!1};var b=(e,t)=>{switch(t.type){case s.Model_Open_Create_Node:return{...e,ModelOpen:!0,modalPayload:{title:"Create Node",submitText:"Create Node",type:"Node",Children:o,defaultStyle:c,defaultLabel:"",labelAllowed:!0,cb:t.cb}};case s.Model_Open_Create_Edge:return{...e,ModelOpen:!0,modalPayload:{title:"Create Edge",submitText:"Create Edge",Children:d,defaultStyle:h,defaultLabel:"",labelAllowed:!0,cb:t.cb}};case s.Model_Open_Update_Node:return{...e,ModelOpen:!0,modalPayload:{title:"Edit Node",submitText:"Edit Node",type:"Node",Children:o,defaultStyle:t.style,defaultLabel:t.label,labelAllowed:t.labelAllowed,cb:t.cb}};case s.Model_Open_Update_Edge:return{...e,ModelOpen:!0,modalPayload:{title:"Edit Edge",submitText:"Edit Edge",Children:d,defaultStyle:t.style,defaultLabel:t.label,labelAllowed:t.labelAllowed,cb:t.cb}};case s.SET_CONTRIBUTE_MODAL:return{...e,contributeModal:t.payload};case s.Model_Close:return{...e,ModelOpen:!1};case s.ELE_SELECTED:return{...e,eleSelected:!0,eleSelectedPayload:t.payload};case s.ELE_UNSELECTED:return{...e,eleSelected:!1};case s.TURN_DRAW:return{...e,drawModeOn:t.payload};case s.SET_UNDO:return{...e,undoEnabled:t.payload};case s.SET_REDO:return{...e,redoEnabled:t.payload};case s.ADD_GRAPH:{let a=-1;const s=t.payload.graphID||(new Date).getTime().toString();return e.graphs.forEach(((e,r)=>{(e.graphID&&e.graphID===s||e.serverID&&e.serverID===t.payload.serverID)&&(a=r)})),-1!==a?{...e,newGraphModal:!1,curGraphIndex:a}:{...e,newGraphModal:!1,curGraphIndex:e.graphs.length,graphs:[...e.graphs,{...u,projectName:t.payload.projectName,graphID:s,serverID:t.payload.serverID,graphML:t.payload.graphML,fileHandle:t.payload.fileHandle||null,fileName:t.payload.fileName,authorName:t.payload.authorName||""}]}}case s.ADD_GRAPH_BULK:return{...e,graphs:[...e.graphs,...t.payload]};case s.SET_CUR_INSTANCE:return{...e,curGraphInstance:t.payload};case s.SET_CUR_INDEX:case s.CHANGE_TAB:return{...e,curGraphIndex:t.payload};case s.NEW_GRAPH:return{...e,newGraphModal:!0};case s.REMOVE_GRAPH:return{...e,graphs:e.graphs.filter(((e,a)=>a!==t.payload)),curGraphIndex:e.curGraphIndex<t.payload?e.curGraphIndex:Math.max(0,e.curGraphIndex-1)};case s.SET_PROJECT_DETAILS:{const a={...e};return a.graphs=a.graphs.map((e=>e.graphID===t.payload.graphID?{...e,[t.payload.type]:t.payload.value}:e)),{...a}}case s.SET_SHARE_MODAL:return{...e,shareModal:t.payload};case s.SET_OPTIONS_MODAL:return{...e,optionsModal:t.payload};case s.SET_FILE_STATE:return{...e,fileState:t.payload};case s.SET_SETTING_MODAL:return{...e,settingsModal:t.payload};case s.SET_MARKDOWN_MODAL:return{...e,markDownModal:t.payload};case s.SET_INPUT_FILE:return{...e,inputFile:t.payload.content,inputFileName:t.payload.fname};case s.SET_FILE_REF:return{...e,fileRef:t.payload};case s.SET_OPTIONS:return{...e,dockerCheck:t.payload.docker,unlockCheck:t.payload.unlock,params:t.payload.param,maxTime:t.payload.maxT,octave:t.payload.octave,library:t.payload.library};case s.SET_FILE_HANDLE:{const a={...e};return a.graphs=a.graphs.map(((e,a)=>a===t.payload.curGraphIndex?{...e,fileHandle:t.payload.fileHandle}:e)),{...a}}case s.SET_HISTORY_MODAL:return{...e,viewHistory:t.payload};case s.SET_AUTHOR:{const a={...e};return a.graphs=a.graphs.map((e=>e.graphID===t.payload.graphID?{...e,[t.payload.type]:t.payload.value}:e)),{...a}}case s.IS_WORKFLOW_ON_SERVER:return{...e,isWorkflowOnServer:t.payload};case s.SET_ZOOM_LEVEL:return{...e,zoomLevel:t.payload};case s.SET_EDIT_DETAILS_MODAL:return{...e,editDetailsModal:t.payload};case s.SET_NEW_GRAPH_MODAL:return{...e,newGraphModal:t.payload};case s.CHANGE_RESET:return{...e,resetEnabled:t.payload};case s.SET_LOGS_MESSAGE:return{...e,logsmessage:t.payload};case s.SET_LOGS:return{...e,logs:t.payload};case s.EDIT_TEXTFILE:return{...e,textFileModal:t.payload.show,fileObj:t.payload.fileObj,fileHandle:t.payload.fileHandle};case s.SET_DIR_NAME:return{...e,uploadedDirName:t.payload};case s.SET_FUNCTIONS:{const a={...e};return a.graphs[e.curGraphIndex].built=t.payload.built,a.graphs[e.curGraphIndex].debugged=t.payload.debugged,a.graphs[e.curGraphIndex].ran=t.payload.ran,a.graphs[e.curGraphIndex].cleared=t.payload.cleared,a.graphs[e.curGraphIndex].destroyed=t.payload.destroyed,a.graphs[e.curGraphIndex].stopped=t.payload.stopped,{...a}}default:return e}}},70:function(e,t,a){"use strict";const s={style:[...[{selector:"*",style:{overlayOpacity:"0"}},{selector:'node[type = "ordin"]',style:{content:"data(label)",zIndex:100,width:"data(style.width)",height:"data(style.height)",shape:"data(style.shape)",opacity:"data(style.opacity)",backgroundColor:"data(style.backgroundColor)",borderColor:"data(style.borderColor)",borderWidth:"data(style.borderWidth)",textValign:"center",textHalign:"center"}},{selector:'node[type="special"]',style:{width:8,height:8,backgroundColor:"data(style.backgroundColor)",zIndex:1e3}},{selector:"edge",style:{curveStyle:"bezier",targetArrowShape:"triangle"}},{selector:'edge[type = "ordin"]',style:{width:"data(style.thickness)",lineColor:"data(style.backgroundColor)",targetArrowColor:"data(style.backgroundColor)",curveStyle:"segments",segmentDistances:"data(bendData.bendDistance)",segmentWeights:"data(bendData.bendWeight)",edgeDistances:"node-position",lineStyle:"data(style.shape)"}},{selector:"edge[label]",style:{label:"data(label)",edgeTextRotation:"autorotate",zIndex:999,textBackgroundOpacity:1,color:"#000",textBackgroundColor:"#fff",textBackgroundShape:"roundrectangle",textBorderColor:"#fff",textBorderWidth:2,textBorderOpacity:1}},{selector:".hidden",style:{display:"none"}},{selector:'.eh-handle,node[type="bend"]',style:{height:25,width:25,opacity:.4,borderWidth:5,borderOpacity:.1}},{selector:'node[type="bend"]',style:{backgroundColor:"#9575cd"}},{selector:".eh-handle",style:{backgroundColor:"#f50057"}},{selector:":selected",style:{overlayColor:"#000",overlayOpacity:.1,overlayPadding:5}}]],zoomingEnabled:!0,userZoomingEnabled:!0,minZoom:.25,maxZoom:5};t.a=s}},[[341,1,2]]]);
//# sourceMappingURL=main.7163d0b7.chunk.js.map